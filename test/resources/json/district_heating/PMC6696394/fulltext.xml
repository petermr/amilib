<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.2 20190208//EN" "JATS-archivearticle1.dtd"> 
<article xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:mml="http://www.w3.org/1998/Math/MathML" article-type="research-article"><?properties open_access?><?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?><?DTDIdentifier.IdentifierType public?><?SourceDTD.DTDName JATS-journalpublishing1.dtd?><?SourceDTD.Version 1.1?><?ConverterInfo.XSLTName jp2nlmx2.xsl?><?ConverterInfo.Version 1?><front><journal-meta><journal-id journal-id-type="nlm-ta">Materials (Basel)</journal-id><journal-id journal-id-type="iso-abbrev">Materials (Basel)</journal-id><journal-id journal-id-type="publisher-id">materials</journal-id><journal-title-group><journal-title>Materials</journal-title></journal-title-group><issn pub-type="epub">1996-1944</issn><publisher><publisher-name>MDPI</publisher-name></publisher></journal-meta><article-meta><article-id pub-id-type="pmcid">6696394</article-id><article-id pub-id-type="doi">10.3390/ma12152465</article-id><article-id pub-id-type="publisher-id">materials-12-02465</article-id><article-categories><subj-group subj-group-type="heading"><subject>Article</subject></subj-group></article-categories><title-group><article-title>Achieving Lower District Heating Network Temperatures Using Feed-Forward MPC</article-title></title-group><contrib-group><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0001-5520-739X</contrib-id><name><surname>Zimmerman</surname><given-names>Nathan</given-names></name><xref ref-type="aff" rid="af1-materials-12-02465">1</xref><xref rid="c1-materials-12-02465" ref-type="corresp">*</xref></contrib><contrib contrib-type="author"><contrib-id contrib-id-type="orcid" authenticated="true">https://orcid.org/0000-0002-8466-356X</contrib-id><name><surname>Kyprianidis</surname><given-names>Konstantinos</given-names></name><xref ref-type="aff" rid="af1-materials-12-02465">1</xref></contrib><contrib contrib-type="author"><name><surname>Lindberg</surname><given-names>Carl-Fredrik</given-names></name><xref ref-type="aff" rid="af1-materials-12-02465">1</xref><xref ref-type="aff" rid="af2-materials-12-02465">2</xref></contrib></contrib-group><aff id="af1-materials-12-02465"><label>1</label>Department of Automation in Energy and Environment, School of Business, Society and Engineering, M&#x000e4;lardalen University, Box 883, 721 23 V&#x000e4;ster&#x000e5;s, Sweden</aff><aff id="af2-materials-12-02465"><label>2</label>ABB Force Measurement, Tv&#x000e4;rleden 2, 721 36 V&#x000e4;ster&#x000e5;s, Sweden</aff><author-notes><corresp id="c1-materials-12-02465"><label>*</label>Correspondence: <email>nathan.zimmerman@mdh.se</email>; Tel.: +46-21-10-7335</corresp></author-notes><pub-date pub-type="epub"><day>02</day><month>8</month><year>2019</year></pub-date><pub-date pub-type="collection"><month>8</month><year>2019</year></pub-date><volume>12</volume><issue>15</issue><elocation-id>2465</elocation-id><history><date date-type="received"><day>15</day><month>6</month><year>2019</year></date><date date-type="accepted"><day>24</day><month>7</month><year>2019</year></date></history><permissions><copyright-statement>&#x000a9; 2019 by the authors.</copyright-statement><copyright-year>2019</copyright-year><license license-type="open-access"><license-p>Licensee MDPI, Basel, Switzerland. This article is an open access article distributed under the terms and conditions of the Creative Commons Attribution (CC BY) license (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>).</license-p></license></permissions><abstract><p>The focus of this work is to present the feasibility of lowering the supply and return temperatures of district heating networks in order to achieve energy savings through the implementation of feed-forward model predictive control. The current level of district heating technology dictates a need for higher supply temperatures, which is not the case when considering the future outlook. In part, this can be attributed to the fact that current networks are being controlled by operator experience and outdoor temperatures. The prospects of reducing network temperatures can be evaluated by developing a dynamic model of the process which can then be used for control purposes. Two scenarios are presented in this work, to not only evaluate a controller&#x02019;s performance in supplying lower network temperatures, but to also assess the boundaries of the return temperature. In Scenario 1, the historical load is used as a feed-forward signal to the controller, and in Scenario 2, a load prediction model is used as the feed-forward signal. The findings for both scenarios suggest that the new control approach can lead to a load reduction of 12.5% and 13.7% respectively for the heat being supplied to the network. With the inclusion of predictions with increased accuracy on end-user demand and feed-back, the return temperature values can be better sustained, and can lead to a decrease in supply temperatures and an increase in energy savings on the production side.</p></abstract><kwd-group><kwd>district heating</kwd><kwd>DHN</kwd><kwd>control</kwd><kwd>MPC</kwd><kwd>dynamic modelling</kwd><kwd>feed-forward</kwd><kwd>energy savings</kwd></kwd-group></article-meta></front><body><sec sec-type="intro" id="sec1-materials-12-02465"><title>1. Introduction</title><p>District heating technology is a well established process for distributing localized heat production in order to meet customers&#x02019; spacial and hot water requirements. The heat provider is able to satisfy customer demands through the development and control of a heat distribution network. The centralization of heat production is commonly generated by using combined heat and power plants (CHP), or it can be the byproduct of industrial processes. The primary benefits of district heating (DH) is that it provides lower heating costs in dense urban areas and it contributes to lower environmental impacts due to the centralization of heat production [<xref rid="B1-materials-12-02465" ref-type="bibr">1</xref>]. The centralization of heat and power production decreases the demand for primary energy production by introducing the opportunity to utilize excess heat in the form of a district heating network (DHN) [<xref rid="B2-materials-12-02465" ref-type="bibr">2</xref>]. The ability to lower the supply temperature to DHN has the possibility to not only significantly reduce greenhouse gas emissions, but it can also promote the transition towards integrating more renewable energy sources and lead to a more sustainable energy system [<xref rid="B3-materials-12-02465" ref-type="bibr">3</xref>].</p><p>Currently, most of the installed district heating networks are categorized as third generation DHNs. The first and second generations of district heating were based on high temperature and pressure networks, and subsequently resulted in higher losses. With third generation DH, the typical supply and return temperatures are approximately 80&#x02013; 110 <inline-formula><mml:math id="mm1"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>&#x02218;</mml:mo></mml:msup><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> and 40&#x02013; 50 <inline-formula><mml:math id="mm2"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>&#x02218;</mml:mo></mml:msup><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> respectively [<xref rid="B4-materials-12-02465" ref-type="bibr">4</xref>]. The driving force of replacing high energy content fossil fuels with lower energy bio fuels no longer constrains the temperature boundaries in a DHN. At the temperature levels mentioned above it is possible to satisfy customer needs and increase the DH system&#x02019;s efficiency by operating at the lower end of the referred boundaries. The progression towards lower distribution temperatures has the ability to lower network losses, and is known as fourth generation district heating (4GDH). The underlying philosophy of 4GDH is to be able to achieve annual averages of 50 <inline-formula><mml:math id="mm3"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>&#x02218;</mml:mo></mml:msup><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> in the supply line and 20 <inline-formula><mml:math id="mm4"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>&#x02218;</mml:mo></mml:msup><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> in the return [<xref rid="B2-materials-12-02465" ref-type="bibr">2</xref>]. However, this approach, from the network perspective, could imply that the existing infrastructure would need to be updated, which would require a financial investment from the heat provider [<xref rid="B5-materials-12-02465" ref-type="bibr">5</xref>]. In recent work, Nord et al. [<xref rid="B6-materials-12-02465" ref-type="bibr">6</xref>] present the challenges and potential of gradually decreasing network supply temperatures. Through a series of case studies they incrementally lower the supply temperature from 80 <inline-formula><mml:math id="mm5"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>&#x02218;</mml:mo></mml:msup><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> to 55 <inline-formula><mml:math id="mm6"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>&#x02218;</mml:mo></mml:msup><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, where the trajectory of lowering the temperature is achievable given the current network structure. They found that it is possible to obtain higher heat savings, by reducing the network temperature load, with a minimal increase in the annual pump energy. The gradual progression of reducing the supply temperature is important because existing buildings are currently designed for higher temperature requirements, which amount to one third of the total energy consumed worldwide [<xref rid="B7-materials-12-02465" ref-type="bibr">7</xref>]. The prospects of gradually decreasing the supply temperature could greatly alleviate the financial burden of grid redevelopment. Lowering distribution temperatures to the levels of 4GDH will rely on the assumption that customer substations are working properly and that buildings meet higher energy standards. Both circumstances will be difficult to overcome when cities with existing networks are considered, due to the fact that the current share of buildings requiring higher temperatures is expected to constitute the majority of the heating demand for decades to come [<xref rid="B8-materials-12-02465" ref-type="bibr">8</xref>]. However, according to Gadd et al. [<xref rid="B9-materials-12-02465" ref-type="bibr">9</xref>] it is possible to achieve a supply temperature of 70 <inline-formula><mml:math id="mm7"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>&#x02218;</mml:mo></mml:msup><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> and return temperature of 32 <inline-formula><mml:math id="mm8"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>&#x02218;</mml:mo></mml:msup><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> within the current limitations of third generation DHNs. Furthermore, there are no documented studies of DHNs showing average return temperatures below 30 <inline-formula><mml:math id="mm9"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>&#x02218;</mml:mo></mml:msup><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> [<xref rid="B2-materials-12-02465" ref-type="bibr">2</xref>]. These boundaries are the focus of this work within a third generation network, while the lower temperatures of 4GDH are not considered. These boundaries are however an advancement towards achieving the temperatures of 4GDH.</p><p>The alternative to high investment costs associated with updating the infrastructure of current DHNs is to introduce more efficient control. In practice, the current mode of control is based on operator knowledge and historical consumption patterns based on outdoor temperatures. From the operator&#x02019;s experience they are able to inject heat into the network before it is required with no account of how the load supplied actually affects the end-user. The downside to this approach is that even though the customers&#x02019; demands are met, the return temperature in the network will be higher than it needs to be. This implies that not only is the supply temperature often higher than necessary, but that there is great potential for reducing the DH plant load by reducing the network supply temperature. With the inclusion of more accurate feed-forward and feed-back control, the return temperature can be controlled near a set-point. This suggests that the set-point can be decreased while maintaining the thermal comfort needs of the end-user. To achieve this, model predictive control (MPC) can be utilized to meet the customers&#x02019; demands and to achieve lower return temperatures in the network. This achievement is of great interest to heat providers as it has the potential to reduce the heat load on the plant side, i.e., it would be possible to reduce peak load production during colder months by lowering the network supply temperature.</p></sec><sec id="sec2-materials-12-02465"><title>2. State of the Art-Background</title><p>This section is intended to enlighten the reader to previous works pertaining to the scope of this paper. The topics of modelling and control are not new concepts. However, the combination of both domains, to establish a modelling and control approach, is of significant interest.</p><sec id="sec2dot1-materials-12-02465"><title>2.1. Modelling</title><p>In regards to modelling heat propagation in district heating networks, two approaches come to light, which are black-box and physical modelling. Black-box models operate on the premise that with a given set of input(s) you will be able to obtain the corresponding output(s). However, the basis of such an approach mandates a need for historical process data which can be trained to fit only one case. In comparison, the development of physical models incorporates the physical aspects of a real system, and can be implemented for any case with complete transparency. With a validated physical model it is also possible to evaluate the degree at which different levels of excitation affect the defined system. This information can then be utilized in black-box system identification methods to derive a linear dynamic model around an operating point. The linear model can then be used to design an MPC controller, and in turn, be applied to the physical model. This approach is used in this paper, while previous works on the topic of modelling DHNs using physical models follows below.</p><p>Through the development of dynamic DHN models, the transient behavior of heat propagating through the network is possible to observe. It also allows for the added benefit of not only enabling the investigation of different operational regimes, but also the ongoing development of operational optimization models [<xref rid="B10-materials-12-02465" ref-type="bibr">10</xref>]. Giraud et al. [<xref rid="B11-materials-12-02465" ref-type="bibr">11</xref>] developed and validated components using Modelica, where they are able to use their model to optimize network supply temperature using actual heat load profiles. A functional comparison conducted by Soons et al. [<xref rid="B12-materials-12-02465" ref-type="bibr">12</xref>] compares the different platforms of Dymola (Modelica), Matlab Simulink, and TRNSYS. Their comparison indicates that Modelica performs better in terms of modularity, multi-domain modelling, and realistic control behavior. The obtainable flexibility of using an object-oriented modelling approach increases the capabilities during feasibility studies. In the work by Hermansson et al. [<xref rid="B13-materials-12-02465" ref-type="bibr">13</xref>] a dynamic district heating library in Modelica presents the capability of automating network modelling. By using computer-aided design drawings of a DHN a framework was developed which could automate the modelling and simulation of any network. In order to investigate the prospects of future district heating technology, fourth generation district heating, Schweiger et al. [<xref rid="B14-materials-12-02465" ref-type="bibr">14</xref>] and Kauko et al. [<xref rid="B15-materials-12-02465" ref-type="bibr">15</xref>] demonstrate that Modelica is a suitable modelling language that can efficiently simulate large scale district heating and cooling systems.</p></sec><sec id="sec2dot2-materials-12-02465"><title>2.2. Control</title><p>Traditional control approaches in district heating networks are a function of outdoor temperature and the corresponding load throughout the day. This is especially apparent when comparing summer and winter customer consumption patterns. During the winter, the load from the CHP is much higher because there is a significant need for space heating (SH), and therefore the outdoor temperature captures this. During the summer, the load is significantly reduced, since the requirements of the customer needs are primarily attributed to domestic hot water (DHW) consumption, and therefore the time of the day aids in capturing this profile. According to Laakkonen et al. [<xref rid="B16-materials-12-02465" ref-type="bibr">16</xref>] there is a low level of utilization of automation in supply temperature controls. This is because (a) the transport delay from supplier to consumer is in a continuous flux, (b) it is difficult to estimate the consumers&#x02019; consumption profiles, and (c) there is no exact definition on optimal supply temperature. Therefore, the limits of traditional control remains to be in the hands of those in the control room. From their experience, and the weather forecast, heat is loaded into the network before it is needed, which is done in order to account for long distribution delays.</p><p>An advanced control approach, such as predictive control, can be reviewed in the work of Sandou et al. [<xref rid="B17-materials-12-02465" ref-type="bibr">17</xref>]. They present a method for using a Sequential Quadratic Programming algorithm in a two model approach where a closed loop simulation model is used to update an open loop optimization model. However, there was no consideration on mass flow dynamics, i.e., they assumed a constant mass flow rate. Grosswindhager et al. [<xref rid="B18-materials-12-02465" ref-type="bibr">18</xref>] present a method that uses Fuzzy Direct Matrix Control to control the network supply temperature. The non-linearity of the DHN, caused by the continuous flux in operating flow rate, is controlled by predicting the supply temperature at nodes within the network based on the plant supply temperature and mass flow rate.</p><p>For robust control, model predictive control (MPC) utilizes feedback from the network in order to compensate for prediction errors and model mismatches [<xref rid="B19-materials-12-02465" ref-type="bibr">19</xref>]. In an MPC approach by Saarinen [<xref rid="B20-materials-12-02465" ref-type="bibr">20</xref>] the potential of reducing the DHN supply temperature is investigated in order to evaluate the electricity production at the CHP. The use of operational data is incorporated in order to derive the heat load, return temperature, and transport delay prediction models. The control strategy proved to be favorable by increasing the potential for electricity production from a resulting lower supply temperature. In an approach where fluctuating loads are compensated for, Verrilli et al. [<xref rid="B21-materials-12-02465" ref-type="bibr">21</xref>] present an MPC approach, where the objective function is the associated costs for heat production and the constraints are supply temperature, generator limits, thermal energy storage dynamics, and plant layout. Their resulting optimization problem is modeled as a mixed-integer linear program with logical and continuous variables. A method for MPC, which incorporates the variance of the outdoor temperature, is presented by Cadau et al. [<xref rid="B22-materials-12-02465" ref-type="bibr">22</xref>] for a large municipal building not connected to the DHN. In their approach, they use a dynamic model and MPC in Matlab/Simulink to control the internal building temperature by using dynamic programming. From the dynamic model a simplified grey-box model is incorporated into their MPC, where the cost function to minimized is the overall energy consumption of the building. Giraud et al. [<xref rid="B23-materials-12-02465" ref-type="bibr">23</xref>] use a load prediction model as input in their MPC approach to incorporate production planning and to minimize the supply temperature. By using a combination of linear constraints on different aspects of a DHN and a linearized model of the DHN a Mixed Integer Linear Program is derived.</p><p>A running theme amongst the presented control approaches is the reduction of network supply and return temperatures. The benefits associated with reducing the supply temperature have been shown to reduce distribution heat losses [<xref rid="B24-materials-12-02465" ref-type="bibr">24</xref>], and increase energy efficiency [<xref rid="B25-materials-12-02465" ref-type="bibr">25</xref>]. Additionally, operating at lower supply temperatures can reduce the degree of thermal stress, reducing potential leakages and maintenance [<xref rid="B19-materials-12-02465" ref-type="bibr">19</xref>]. In regards to the return temperature, lower return temperatures improve CHP efficiency by making it possible to extract more heat during flue gas condensing.</p></sec><sec id="sec2dot3-materials-12-02465"><title>2.3. Motivation and Contributions</title><p>Through the development and validation of a dynamic model it is feasible to assess the influence that varying network inputs have on the systems performance, i.e., DHN heat losses and temperature propagation. The multitude of control approaches are numerous, but when it pertains to dealing with network delays and the associated propagation of heat, energy savings can be achieved with better management. Feed-Forward Model Predictive Control (FFMPC) can be implemented to reduce the supply and return temperatures in a DHN while maintaining a more consistent return temperature and upholding the thermal requirements of the end-user. The identification of a predictive model to be used within an MPC is not straight forward and the transparency in the literature in regards to this as well as the horizons used is limited. The contributions of this work is to address the following two questions:<list list-type="order"><list-item><p>What are the potential energy savings from implementing feed-forward model predictive control in district heating networks?</p></list-item><list-item><p>To what level of certainty is required, in regards to feed-forward signals, in order to reduce the supply and return temperatures in a district heating network?</p></list-item></list></p></sec></sec><sec id="sec3-materials-12-02465"><title>3. Method</title><p>In this section, a short description of the DHN is first presented in order to highlight the motivation of this work. Thereafter, the physical model development, model equations and structure are explained. The system of equations used to predict heat propagation and heat delays are important for accurately modelling distribution temperatures over any distances within a DHN. This is proceeded by introducing model predictive control.</p><sec id="sec3dot1-materials-12-02465"><title>3.1. Description of the District Heating Network</title><p>The DHN presented in this study is an aggregated perspective of the region Tillberga, which is situated in V&#x000e4;ster&#x000e5;s, Sweden, approximately <inline-formula><mml:math id="mm10"><mml:mrow><mml:mrow><mml:mn>14</mml:mn><mml:mo>.</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="mm11"><mml:mrow><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:math></inline-formula><inline-formula><mml:math id="mm12"><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:math></inline-formula> from the heat supplier. The reasons for choosing Tillberga are due to the fact of having access to historical network measurements, and because it largely consists of residential housing, where as of 2018, was recorded having a population of 2164 inhabitants [<xref rid="B26-materials-12-02465" ref-type="bibr">26</xref>]. By analysing the historical network measurements from 2016 to 2018 it was determined that the heat demand ranged from 400 <inline-formula><mml:math id="mm13"><mml:mrow><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:math></inline-formula><inline-formula><mml:math id="mm14"><mml:mrow><mml:mi mathvariant="normal">W</mml:mi></mml:mrow></mml:math></inline-formula> in the summer to <inline-formula><mml:math id="mm15"><mml:mrow><mml:mrow><mml:mn>7</mml:mn><mml:mo>.</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="mm16"><mml:mrow><mml:mi mathvariant="normal">M</mml:mi></mml:mrow></mml:math></inline-formula><inline-formula><mml:math id="mm17"><mml:mrow><mml:mi mathvariant="normal">W</mml:mi></mml:mrow></mml:math></inline-formula> in the winter. During this period it was also observed that the highest and lowest outdoor temperatures measured were 32 <inline-formula><mml:math id="mm18"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>&#x02218;</mml:mo></mml:msup><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm19"><mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>21</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="mm20"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>&#x02218;</mml:mo></mml:msup><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> respectively, and are inversely related to the heat demand. Therefore, as the outdoor temperature drops, the requirements for heating will also increase, but the delay of the heat from supply to consumption is in continuous flux. This is due to the fact that the delay time is a function of the network mass flow rate, pipe diameter, and length. Since pipe dimensions are fixed in established networks, the delay time will be arbitrated by the network mass flow. Illustrated in <xref ref-type="fig" rid="materials-12-02465-f001">Figure 1</xref> is a depiction of the delay time for Tillberga from 2016 to 2018. It can be observed that the seasonal variation plays a large roll in the delay time. During the winter periods, i.e., November to March, when the outdoor temperatures are typically below 0 <inline-formula><mml:math id="mm21"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>&#x02218;</mml:mo></mml:msup><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, the delay times are at the lowest points in <xref ref-type="fig" rid="materials-12-02465-f001">Figure 1</xref>. This is a result of continuous heating requirements by the end-users, which facilitates a higher network mass flow, and therefore lower delay times, where the opposite effect happens during the warmer periods of the year. From the analysis of the variation in distribution delays it can be observed that the shortest historical delay achieved during this time period is approximately 5 h. Therefore, the injection of heat from the supplier needs to be initiated at least 5 h before it is required by the end-user.</p></sec><sec id="sec3dot2-materials-12-02465"><title>3.2. Physical Model</title><p>The model presented has been developed in Dymola, version 2018, by Dassault Syst&#x000e9;ms. Dymola offers a simulation environment that is capable of handling complex dynamic systems by solving ordinary and algebraic differential equations. The programming language Modelica is used to design individual components to represent a DHN, i.e., pipes, valves, pumps, junctions, and heat consumers, in a physical way.</p><p>The goal in a DHN is to be able to supply the end-user with enough hot water, i.e., heat, to match their needs. Traditionally, this is accomplished on the heat generation side by injecting higher than necessary temperatures into the grid in order to meet customer demands. Yliniemi [<xref rid="B27-materials-12-02465" ref-type="bibr">27</xref>] reports that for the case of Sweden, which produces about 50 TWh, a potential savings of 50 million Swedish Kronor can be achieved by reducing the network distribution temperature by one degree. Therefore, when modelling a DHN it is essential to accurately predict the network temperature propagation, and is of significant interest in regards to the customers located the farthest distance away from the CHP. In order to capture the temperature dynamics as the heat propagates through the network a pipe model has been developed. Illustrated in <xref ref-type="fig" rid="materials-12-02465-f002">Figure 2</xref> are the principle components of the pipe that are incorporated into the model. The shaded area represents a given control volume length <inline-formula><mml:math id="mm22"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> for a pipe of any length. The temperature of the water exiting the pipe, and therefore the ability to calculate heat propagation, is calculated using Equation (<xref ref-type="disp-formula" rid="FD1-materials-12-02465">1</xref>):<disp-formula id="FD1-materials-12-02465"><label>(1)</label><mml:math id="mm23"><mml:mrow><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>out</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mover accent="true"><mml:mi>m</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>in</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>out</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Q</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>c</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="mm24"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>out</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> ( <inline-formula><mml:math id="mm25"><mml:mrow><mml:mi mathvariant="normal">K</mml:mi></mml:mrow></mml:math></inline-formula>) is the calculated temperature out of control volume <italic>i</italic>, <inline-formula><mml:math id="mm26"><mml:mrow><mml:mover accent="true"><mml:mi>m</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> ( <inline-formula><mml:math id="mm27"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>/<inline-formula><mml:math id="mm28"><mml:mrow><mml:msup><mml:mi mathvariant="normal">s</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>) is the mass flow rate, <italic>c</italic> ( <inline-formula><mml:math id="mm29"><mml:mrow><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:math></inline-formula><inline-formula><mml:math id="mm30"><mml:mrow><mml:mi mathvariant="normal">J</mml:mi></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="mm31"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="mm32"><mml:mrow><mml:msup><mml:mi mathvariant="normal">K</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>) is the specific heat of the working medium, <inline-formula><mml:math id="mm33"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>in</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> ( <inline-formula><mml:math id="mm34"><mml:mrow><mml:mi mathvariant="normal">K</mml:mi></mml:mrow></mml:math></inline-formula>) is the temperature of the water entering the control volume <italic>i</italic>, and <inline-formula><mml:math id="mm35"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Q</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> ( <inline-formula><mml:math id="mm36"><mml:mrow><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:math></inline-formula><inline-formula><mml:math id="mm37"><mml:mrow><mml:mi mathvariant="normal">W</mml:mi></mml:mrow></mml:math></inline-formula>) is the calculated rate of heat loss defined by Equation (<xref ref-type="disp-formula" rid="FD2-materials-12-02465">2</xref>):<disp-formula id="FD2-materials-12-02465"><label>(2)</label><mml:math id="mm38"><mml:mrow><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Q</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>U</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mi>pipe</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi mathvariant="normal">w</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>soil</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>
where <italic>U</italic> ( <inline-formula><mml:math id="mm39"><mml:mrow><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:math></inline-formula><inline-formula><mml:math id="mm40"><mml:mrow><mml:mi mathvariant="normal">W</mml:mi></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="mm41"><mml:mrow><mml:msup><mml:mi mathvariant="normal">m</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="mm43"><mml:mrow><mml:msup><mml:mi mathvariant="normal">K</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>) is the heat transfer coefficient, <italic>A</italic> ( <inline-formula><mml:math id="mm44"><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:math></inline-formula><inline-formula><mml:math id="mm45"><mml:mrow><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>) is the cross-section area of the pipe, <inline-formula><mml:math id="mm46"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">w</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> ( <inline-formula><mml:math id="mm47"><mml:mrow><mml:mi mathvariant="normal">K</mml:mi></mml:mrow></mml:math></inline-formula>) is the temperature of the pipe wall, <inline-formula><mml:math id="mm48"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>soil</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> ( <inline-formula><mml:math id="mm49"><mml:mrow><mml:mi mathvariant="normal">K</mml:mi></mml:mrow></mml:math></inline-formula>) is the temperature of the ground surrounding the pipe, and <inline-formula><mml:math id="mm50"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the mass of the inventory and can be calculated for each control volume as <inline-formula><mml:math id="mm51"><mml:mrow><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mspace width="0.166667em"/><mml:mi>&#x000b7;</mml:mi><mml:mspace width="0.166667em"/><mml:mi>&#x003c1;</mml:mi><mml:mspace width="0.166667em"/><mml:mi>&#x000b7;</mml:mi><mml:mspace width="0.166667em"/><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:math></inline-formula> (kg). The heat transfer coefficient was calculated from Equation (<xref ref-type="disp-formula" rid="FD3-materials-12-02465">3</xref>):<disp-formula id="FD3-materials-12-02465"><label>(3)</label><mml:math id="mm52"><mml:mrow><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>U</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mfenced separators="" open="(" close=")"><mml:mfrac><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mspace width="0.166667em"/><mml:mi>&#x000b7;</mml:mi><mml:mspace width="0.166667em"/><mml:mi>l</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>&#x003bb;</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mspace width="0.166667em"/><mml:mi>&#x000b7;</mml:mi><mml:mspace width="0.166667em"/><mml:mi>l</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:msub><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:msub></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>&#x003bb;</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mfenced><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="mm53"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm54"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="mm55"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> (m) are the pipe diameters referenced in <xref ref-type="fig" rid="materials-12-02465-f002">Figure 2</xref> for the internal pipe inside diameter, internal pipe outside diameter, and the outer most diameter of the pipe respectively. <inline-formula><mml:math id="mm56"><mml:mrow><mml:msub><mml:mi>&#x003bb;</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm57"><mml:mrow><mml:msub><mml:mi>&#x003bb;</mml:mi><mml:mi mathvariant="normal">i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> are the conductive heat transfer coefficients ( <inline-formula><mml:math id="mm58"><mml:mrow><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:math></inline-formula><inline-formula><mml:math id="mm59"><mml:mrow><mml:mi mathvariant="normal">W</mml:mi></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="mm49931"><mml:mrow><mml:msup><mml:mi mathvariant="normal">m</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="mm42893"><mml:mrow><mml:msup><mml:mi mathvariant="normal">K</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>) for water and the polyurethane insulation around the pipe. The temperature of the pipe wall <inline-formula><mml:math id="mm63"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">w</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> ( <inline-formula><mml:math id="mm64"><mml:mrow><mml:mi mathvariant="normal">K</mml:mi></mml:mrow></mml:math></inline-formula>) was calculated from Equation (<xref ref-type="disp-formula" rid="FD4-materials-12-02465">4</xref>):<disp-formula id="FD4-materials-12-02465"><label>(4)</label><mml:math id="mm65"><mml:mrow><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>&#x003b1;</mml:mi><mml:mi>&#x003c0;</mml:mi><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>out</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">w</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>U</mml:mi><mml:mi>&#x003c0;</mml:mi><mml:msub><mml:mi>d</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>soil</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">w</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>&#x003c1;</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:mi>&#x003c0;</mml:mi><mml:mo>(</mml:mo><mml:msubsup><mml:mi>d</mml:mi><mml:mi mathvariant="normal">p</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mn>4</mml:mn></mml:mfrac><mml:mi>c</mml:mi><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi mathvariant="normal">w</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="mm66"><mml:mrow><mml:mi>&#x003b1;</mml:mi></mml:mrow></mml:math></inline-formula> is the convective heat transfer coefficient ( <inline-formula><mml:math id="mm67"><mml:mrow><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:math></inline-formula><inline-formula><mml:math id="mm68"><mml:mrow><mml:mi mathvariant="normal">W</mml:mi></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="mm49931111"><mml:mrow><mml:msup><mml:mi mathvariant="normal">m</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="mm42822293"><mml:mrow><mml:msup><mml:mi mathvariant="normal">K</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>) of water, <inline-formula><mml:math id="mm72"><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi mathvariant="normal">i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> (m) is the length of the control volume, <inline-formula><mml:math id="mm73"><mml:mrow><mml:msub><mml:mi>&#x003c1;</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the pipe wall density ( <inline-formula><mml:math id="mm74"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="mm75"><mml:mrow><mml:msup><mml:mi mathvariant="normal">m</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>), and <italic>c</italic> is the specific heat of the pipe wall ( <inline-formula><mml:math id="mm77"><mml:mrow><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:math></inline-formula><inline-formula><mml:math id="mm78"><mml:mrow><mml:mi mathvariant="normal">J</mml:mi></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="mm71231669"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="mm81316940"><mml:mrow><mml:msup><mml:mi mathvariant="normal">K</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>). The convective heat transfer coefficient <inline-formula><mml:math id="mm81"><mml:mrow><mml:mi>&#x003b1;</mml:mi></mml:mrow></mml:math></inline-formula> was calculated from Equation (<xref ref-type="disp-formula" rid="FD5-materials-12-02465">5</xref>):<disp-formula id="FD5-materials-12-02465"><label>(5)</label><mml:math id="mm82"><mml:mrow><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>&#x003b1;</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>N</mml:mi><mml:mi>u</mml:mi><mml:msub><mml:mi>&#x003bb;</mml:mi><mml:mi mathvariant="normal">w</mml:mi></mml:msub></mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">i</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="mm83"><mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mi>u</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> is Nusselt&#x02019;s number and was calculated from Equation (<xref ref-type="disp-formula" rid="FD6-materials-12-02465">6</xref>):<disp-formula id="FD6-materials-12-02465"><label>(6)</label><mml:math id="mm84"><mml:mrow><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>N</mml:mi><mml:mi>u</mml:mi><mml:mo>=</mml:mo><mml:mfenced separators="" open="[" close="]"><mml:mfrac><mml:mi>f</mml:mi><mml:mn>8</mml:mn></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mi>R</mml:mi><mml:mi>e</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1000</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mi>r</mml:mi></mml:mfenced><mml:mspace width="0.166667em"/><mml:mi>&#x000b7;</mml:mi><mml:mspace width="0.166667em"/><mml:msup><mml:mfenced separators="" open="[" close="]"><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mn>12</mml:mn><mml:mo>.</mml:mo><mml:mn>7</mml:mn><mml:msup><mml:mfenced open="(" close=")"><mml:mfrac><mml:mi>f</mml:mi><mml:mn>8</mml:mn></mml:mfrac></mml:mfenced><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>P</mml:mi><mml:msup><mml:mi>r</mml:mi><mml:mfrac><mml:mn>2</mml:mn><mml:mn>3</mml:mn></mml:mfrac></mml:msup><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mfenced><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>
where <italic>f</italic> is the friction factor, which can handle laminar and turbulent flows, was calculated from Equations (<xref ref-type="disp-formula" rid="FD7-materials-12-02465">7</xref>) and (8) by using the Reynold&#x02019;s number Equation (9):
<disp-formula id="FD7-materials-12-02465"><label>(7)</label><mml:math id="mm85"><mml:mrow><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:mn>8</mml:mn><mml:msup><mml:mfenced separators="" open="[" close="]"><mml:msup><mml:mfenced open="(" close=")"><mml:mfrac><mml:mn>8</mml:mn><mml:mrow><mml:mi>R</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mn>12</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>&#x003c9;</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>&#x003c9;</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mfrac></mml:mfenced><mml:mfrac><mml:mn>1</mml:mn><mml:mn>12</mml:mn></mml:mfrac></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>
<disp-formula id="FD8-materials-12-02465"><label>(8)</label><mml:math id="mm86"><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>&#x003c9;</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mfenced separators="" open="[" close="]"><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn><mml:mo>.</mml:mo><mml:mn>457</mml:mn><mml:mspace width="0.166667em"/><mml:mi>&#x000b7;</mml:mi><mml:mspace width="0.166667em"/><mml:mi>ln</mml:mi><mml:mfenced separators="" open="(" close=")"><mml:msup><mml:mfrac><mml:mn>7</mml:mn><mml:mrow><mml:mi>R</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:mfrac><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>27</mml:mn><mml:mfrac><mml:mi>&#x003f5;</mml:mi><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">i</mml:mi></mml:msub></mml:mfrac></mml:mfenced></mml:mfenced><mml:mn>16</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>&#x003c9;</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mfenced open="(" close=")"><mml:mfrac><mml:mn>37530</mml:mn><mml:mrow><mml:mi>R</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mn>16</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math></disp-formula>
<disp-formula id="FD9-materials-12-02465"><label>(9)</label><mml:math id="mm88"><mml:mrow><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>R</mml:mi><mml:mi>e</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>&#x003c1;</mml:mi><mml:mi mathvariant="normal">w</mml:mi></mml:msub><mml:mi>v</mml:mi><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">i</mml:mi></mml:msub></mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="mm89"><mml:mrow><mml:msub><mml:mi>&#x003c1;</mml:mi><mml:mi mathvariant="normal">w</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> ( <inline-formula><mml:math id="mm90"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="mm81321216940"><mml:mrow><mml:msup><mml:mi mathvariant="normal">m</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>) is the density of water, <italic>v</italic> ( <inline-formula><mml:math id="mm921033"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="normal">m</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>) is the velocity calculated from the mass flow rate, <inline-formula><mml:math id="mm95"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi mathvariant="normal">i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the pipe inside diameter in meters, and <inline-formula><mml:math id="mm96"><mml:mrow><mml:mi>&#x003bc;</mml:mi></mml:mrow></mml:math></inline-formula> ( <inline-formula><mml:math id="mm97"><mml:mrow><mml:mi mathvariant="normal">N</mml:mi></mml:mrow></mml:math></inline-formula><inline-formula><mml:math id="mm98"><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="mm99"><mml:mrow><mml:msup><mml:mi mathvariant="normal">m</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>) is the water viscosity. From the heat losses described in Equation (<xref ref-type="disp-formula" rid="FD2-materials-12-02465">2</xref>) it is also possible to estimate the temperature loss over a defined control volume, and has been calculated by using Equation (10):
<disp-formula id="FD10-materials-12-02465"><label>(10)</label><mml:math id="mm101"><mml:mrow><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mover accent="true"><mml:mi>Q</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>m</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mi>c</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="mm102"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> ( <inline-formula><mml:math id="mm103"><mml:mrow><mml:mi mathvariant="normal">K</mml:mi></mml:mrow></mml:math></inline-formula>) is the temperature loss, <inline-formula><mml:math id="mm104"><mml:mrow><mml:mover accent="true"><mml:mi>m</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> ( <inline-formula><mml:math id="mm105"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="mm106"><mml:mrow><mml:msup><mml:mi mathvariant="normal">s</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>) is the mass flow rate, <italic>c</italic> ( <inline-formula><mml:math id="mm107"><mml:mrow><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:math></inline-formula><inline-formula><mml:math id="mm108"><mml:mrow><mml:mi mathvariant="normal">J</mml:mi></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="mm109"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="mm110"><mml:mrow><mml:msup><mml:mi mathvariant="normal">k</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>) is the specific heat, and <inline-formula><mml:math id="mm111"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Q</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> was calculated from Equation (<xref ref-type="disp-formula" rid="FD2-materials-12-02465">2</xref>). In order to determine the temperature propagating through the network or the new temperature after heat is consumed or lost, Equation (<xref ref-type="disp-formula" rid="FD1-materials-12-02465">1</xref>) can be modified into Equation (11):
<disp-formula id="FD11-materials-12-02465"><label>(11)</label><mml:math id="mm112"><mml:mrow><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>T</mml:mi><mml:mi>out</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mover accent="true"><mml:mi>m</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>in</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>out</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Q</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Q</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mi>load</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>
where the addition of <inline-formula><mml:math id="mm113"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Q</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mi>load</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> represents the rate of heat (kW) consumed by the end user. It should be noted that for all calculations, since water is incompressible, it is assumed that the density, specific heat, and viscosity remain constant. If <inline-formula><mml:math id="mm114"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Q</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mi>load</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is unknown, but the mass flow rate, inlet and outlet temperatures are known it is possible to calculate the rate of heat being consumed, by utilizing Equation (12):
<disp-formula id="FD12-materials-12-02465"><label>(12)</label><mml:math id="mm115"><mml:mrow><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Q</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>a</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mi>m</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>With an accurate representation of heat as it moves through a given pipe, it is also of interest to determine how long, delay time <inline-formula><mml:math id="mm116"><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow></mml:math></inline-formula>, it takes for the temperature being supplied from the CHP to reach any given location downstream. This is achievable by knowing the installed pipe area, length, and mass flow rate of the water, which is represented in Equation (13):
<disp-formula id="FD13-materials-12-02465"><label>(13)</label><mml:math id="mm117"><mml:mrow><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>&#x003c4;</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mi>&#x003c1;</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mover accent="true"><mml:mi>m</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="mm118"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> ( <inline-formula><mml:math id="mm119"><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:math></inline-formula><inline-formula><mml:math id="mm120"><mml:mrow><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>) is the inside pipe cross-sectional area and L ( <inline-formula><mml:math id="mm121"><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:math></inline-formula>) is the length of the pipe. The density <inline-formula><mml:math id="mm122"><mml:mrow><mml:mi>&#x003c1;</mml:mi></mml:mrow></mml:math></inline-formula> is taken to be constant at 990 <inline-formula><mml:math id="mm123"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="mm125"><mml:mrow><mml:msup><mml:mi mathvariant="normal">m</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm126"><mml:mrow><mml:mover accent="true"><mml:mi>m</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> is the mass flow rate of the distribution line. In order to estimate the amount of heat in the distribution and return lines over a specified time period, and the rate at which heat is being transferred (heat flux), Equations (14) and (15) were respectively calculated:
<disp-formula id="FD14-materials-12-02465"><label>(14)</label><mml:math id="mm127"><mml:mrow><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mo>&#x0222b;</mml:mo><mml:mover accent="true"><mml:mi>m</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="0.277778em"/><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>
<disp-formula id="FD15-materials-12-02465"><label>(15)</label><mml:math id="mm128"><mml:mrow><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>Q</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mi>m</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>
where <italic>Q</italic> ( <inline-formula><mml:math id="mm129"><mml:mrow><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:math></inline-formula><inline-formula><mml:math id="mm130"><mml:mrow><mml:mi mathvariant="normal">J</mml:mi></mml:mrow></mml:math></inline-formula>) is the amount of heat over a specified time period for either the network&#x02019;s supply or return line, <inline-formula><mml:math id="mm131"><mml:mrow><mml:mover accent="true"><mml:mi>m</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> ( <inline-formula><mml:math id="mm132"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="mm133"><mml:mrow><mml:msup><mml:mi mathvariant="normal">s</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>) is the mass flow rate, <italic>c</italic> ( <inline-formula><mml:math id="mm134"><mml:mrow><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:math></inline-formula><inline-formula><mml:math id="mm135"><mml:mrow><mml:mi mathvariant="normal">J</mml:mi></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="mm136"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="mm137"><mml:mrow><mml:msup><mml:mi mathvariant="normal">K</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>) is the specific heat of the water, <italic>T</italic> ( <inline-formula><mml:math id="mm138"><mml:mrow><mml:mi mathvariant="normal">K</mml:mi></mml:mrow></mml:math></inline-formula>) can either be the CHP supply temperature or the end-user return temperature, <inline-formula><mml:math id="mm139"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> ( <inline-formula><mml:math id="mm140"><mml:mrow><mml:mi mathvariant="normal">K</mml:mi></mml:mrow></mml:math></inline-formula>) is the reference temperature, and <inline-formula><mml:math id="mm141"><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>Q</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">W</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> is the intensity of the heat flow in either the supply or return line. The reference temperature in this case is considered to be 21 <inline-formula><mml:math id="mm142"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>&#x02218;</mml:mo></mml:msup><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> and represents the desired indoor temperature of the end-user. This reference temperature has been chosen on the premise of it being the temperature of the heat sink, and therefore no positive heat transfer is achievable below this temperature. Equations (14) and (15) are intended to establish a reference point so that the control results to be presented can be compared with historical values. Equation (14) will provide a quantitative perspective as to how much heat has been transported in the distribution and return lines over a specified time period and Equation (15) will provide insight into the rate at which this heat is flowing. The formulation of these two equations makes it possible to calculate the potential energy savings and to visualize the possibility of peak heat load reduction over time.</p></sec><sec id="sec3dot3-materials-12-02465"><title>3.3. Model Predictive Control</title><p>MPC is a multivariate control method that utilizes an internal prediction model in order to predict the future behavior of a system over a determined prediction horizon while considering constraints. The model that the MPC uses in this work is a multiple-input-single-output (MISO) discrete-time ARMAX model (Auto-Regressive Moving Average model with eXogenenous inputs) that was estimated through system identification. The non-linear relationship between the inputs and output can be approximated from a linear model with fixed-time delays. When the MPC receives signals for the measured disturbances and feed-back, a sequence of control actions are calculated and an optimization algorithm minimizes a determined cost function in order to predict the future behavior [<xref rid="B28-materials-12-02465" ref-type="bibr">28</xref>].</p></sec><sec id="sec3dot4-materials-12-02465"><title>3.4. Overview of Prediction Model</title><p>In order to estimate the discrete-time ARMAX model it was first important to choose an appropriate sampling time. Due to the long delays in the DHN from supply to consumption a sampling time of one hour has been used. The next step was to artificially generate, within operating limits, the necessary input signals into the physical model in order to generate an output response for the outputs of interest. In this work the input signals are: CHP supply temperature, mass flow rate, and end-user demand. Therefore, from the generated inputs and associated output it was possible to identify which signals are to be controllable (CHP supply temperature and mass flow rate), which signals are going to be a measured disturbance (end-user demand), and what is to be controlled (return temperature from the end-user). Different model orders and methods need to be tested in order to obtain an optimal fit. As a first choice, a simple first order model was derived by using the input-output data from the open loop simulation of the validated physical model, and can be seen in Equation (16):
<disp-formula id="FD16-materials-12-02465"><label>(16)</label><mml:math id="mm143"><mml:mrow><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>y</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mi>y</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>u</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:msub><mml:mi>u</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>&#x003c4;</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>
where <italic>y</italic> is the return temperature, <inline-formula><mml:math id="mm144"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are the CHP supply temperature, mass flow rate, and end-user demand respectively, the parameters <italic>a</italic> and <inline-formula><mml:math id="mm145"><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>&#x02212;</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are the estimated parameters for return temperature, CHP supply temperature, mass flow rate, and end-user demand respectively. At time <italic>k</italic> it is possible to calculate the return temperature based on the previous return temperature, the current mass flow rate, and the heat demand. A fixed variable time delay <inline-formula><mml:math id="mm146"><mml:mrow><mml:mi>&#x003c4;</mml:mi></mml:mrow></mml:math></inline-formula> is used to delay the supply temperature in order to estimate the actual temperature being received in the DHN.</p><p>This first order model was initially utilized as the MPC&#x02019;s internal prediction model. A feed-forward model predictive controller (FFMPC) was then designed and developed in Matlab-Simulink by implementing a fixed six hour input-delay on the end-user heat demand where the physical model was connected to the MPC by using the Dymola-Simulink interface. The MPC block has three inputs: return temperature from the end-user, return temperature set-point, and measured disturbance, and two outputs: the control signals for CHP supply temperature and mass flow rate. The controller was then used to generate data in a closed loop simulation by making step-changes in the return temperature and the heat demand. The step-changes were generated by calculating the mean and standard deviation from historical process data, and a normal random distribution function was developed in order to generate the necessary steps in time. In this way, a good level of excitation can be achieved in both the amplitude and frequency domains, where the controller then has to a adjust the supply temperature and mass flow in order to maintain the return temperature set-point. This new set of input-output data was then used to identify a first order discrete-time ARMAX model, as defined by Equation (17):
<disp-formula id="FD17-materials-12-02465"><label>(17)</label><mml:math id="mm147"><mml:mrow><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>A</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>z</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>y</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:msub><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>z</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mi>n</mml:mi><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>z</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>e</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="mm148"><mml:mrow><mml:mrow><mml:mi>y</mml:mi><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the system output at time <italic>k</italic>, <inline-formula><mml:math id="mm149"><mml:mrow><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula> are the system inputs, <inline-formula><mml:math id="mm150"><mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> denotes any corresponding delay to the inputs, <inline-formula><mml:math id="mm151"><mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> is the system disturbance, and due to there being three input signals <inline-formula><mml:math id="mm152"><mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>. <inline-formula><mml:math id="mm153"><mml:mrow><mml:mrow><mml:mi>A</mml:mi><mml:mo>(</mml:mo><mml:mi>z</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm154"><mml:mrow><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>z</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="mm155"><mml:mrow><mml:mrow><mml:mi>C</mml:mi><mml:mo>(</mml:mo><mml:mi>z</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> are the polynomials defined by Equations (18)&#x02013;(20), of degree <inline-formula><mml:math id="mm156"><mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm157"><mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="mm158"><mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> respectively, where the polynomials are represented by the backward shift operator <inline-formula><mml:math id="mm159"><mml:mrow><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, i.e., <inline-formula><mml:math id="mm160"><mml:mrow><mml:mrow><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></inline-formula>.
<disp-formula id="FD18-materials-12-02465"><label>(18)</label><mml:math id="mm161"><mml:mrow><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>A</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>z</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi>n</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>
<disp-formula id="FD19-materials-12-02465"><label>(19)</label><mml:math id="mm162"><mml:mrow><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>z</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi>n</mml:mi><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>
<disp-formula id="FD20-materials-12-02465"><label>(20)</label><mml:math id="mm163"><mml:mrow><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>z</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mi>z</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi>n</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula></p><p>Various polynomial orders were selected and tested for <inline-formula><mml:math id="mm164"><mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm165"><mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, and <inline-formula><mml:math id="mm166"><mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. It was determined that <inline-formula><mml:math id="mm167"><mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> = 1, <inline-formula><mml:math id="mm168"><mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> = [1 1 1], <inline-formula><mml:math id="mm169"><mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> = 2, and <inline-formula><mml:math id="mm170"><mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> = [6 1 6] (supply temperature, mass flow rate, and heat demand) provided a fit to the estimation data of 89.7% using prediction as the focus. A second set of data was randomly generated, as described above, in order to evaluate the model, and it was found that the ARMAX model provided a fit of 71%.</p><p>The MPC&#x02019;s performance when a step is initialized in the measured disturbance, i.e., end-user load, is illustrated in <xref ref-type="fig" rid="materials-12-02465-f003">Figure 3</xref>. The feed-forward perspective of the controller can be observed in <xref ref-type="fig" rid="materials-12-02465-f003">Figure 3</xref>b (red dash-line), at time <italic>k</italic> the MPC receives the load prediction 6 h in advance. Since the controller has the ability to receive information on the end-user load in advance it can increase the supply temperature from the CHP in order to accommodate the future influx of required heat, and is illustrated in <xref ref-type="fig" rid="materials-12-02465-f003">Figure 3</xref>c. It can also be observed in <xref ref-type="fig" rid="materials-12-02465-f003">Figure 3</xref>c that the supply temperature to the end-user is delayed due to the constant mass flow rate in <xref ref-type="fig" rid="materials-12-02465-f003">Figure 3</xref>d. However, the step response shows that the supply temperature to the end-user begins to increase before the actual load is initialized at time <inline-formula><mml:math id="mm171"><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>. The controller then takes the action of mitigating this temperature increase by adjusting the mass flow rate, as illustrated in <xref ref-type="fig" rid="materials-12-02465-f003">Figure 3</xref>d, in order to reduce the amount of heat being supplied. Once the full extent of the load is observed, <xref ref-type="fig" rid="materials-12-02465-f003">Figure 3</xref>b (blue dash-line), the controller produces an increase in the mass flow rate. This is why there is an observable decrease in the return temperature in <xref ref-type="fig" rid="materials-12-02465-f003">Figure 3</xref>a. However, as the full extent of the supply temperature has not yet reached its final value, the controller makes a series of small adjustment to the mass flow where it can then be observed that the return temperature is able to settle around its set-point. Within the MPC, other parameters of interest, which require tuning are the prediction and control horizons.</p><p>Given the current control interval <italic>k</italic> and any observed measured disturbances, the prediction horizon <italic>p</italic> is the required number of future control intervals that the MPC needs to evaluate when determining the manipulable variables. Since the prediction horizon is discrete at each control step, the determined controller outputs are only observed at each time-step. The prediction horizon then moves forward one step and reevaluates and updates the system variables. In this case, the manipulated variables are the CHP supply temperature and mass flow rate. The control horizon <italic>c</italic> is the number of manipulable variable moves to be optimized at the control interval <italic>k</italic>, where at each control interval they are updated and reevaluated. For this MPC, the prediction and control horizons used are 8 and 10 respectively. This is because the mass flow rate has faster dynamics than the supply temperature, meaning that an instantaneous change in the flow rate is observable in the return temperature, as illustrated in <xref ref-type="fig" rid="materials-12-02465-f003">Figure 3</xref>a,d. It was determined that using the mentioned horizons allows for the supply temperature to change, due to the delay, and that the mass flow rate reacts when there is a substantial change in the return temperature.</p></sec></sec><sec sec-type="results" id="sec4-materials-12-02465"><title>4. Results and Discussion</title><sec id="sec4dot1-materials-12-02465"><title>4.1. Validation</title><p>Illustrated in <xref ref-type="fig" rid="materials-12-02465-f004">Figure 4</xref> are the achieved results for simulation the supply and return temperatures for Tillberga for January 2017. The only inputs utilized in the model are historical values for the temperature and mass flow rate being supplied from the CHP, the ground temperature, and the load. It can be observed in <xref ref-type="fig" rid="materials-12-02465-f004">Figure 4</xref>a that the model can adequately predict the heat propagating, and losses through the network over a distance of <inline-formula><mml:math id="mm172"><mml:mrow><mml:mrow><mml:mn>14</mml:mn><mml:mo>.</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="mm173"><mml:mrow><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:math></inline-formula><inline-formula><mml:math id="mm174"><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow></mml:math></inline-formula>, i.e., the simulated (red dash-line) are following the trends of the actual temperature (black line). It is also possible to take note of the distribution delay and losses since there is a noticeable shift in the temperature being supplied from the CHP (blue-dot line) and a 2&#x02013;5 <inline-formula><mml:math id="mm175"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>&#x02218;</mml:mo></mml:msup><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> drop in the supplied temperature. The modelled vs. actual return temperature in <xref ref-type="fig" rid="materials-12-02465-f004">Figure 4</xref>b is also within good agreement, and is calculated using the load from <xref ref-type="fig" rid="materials-12-02465-f004">Figure 4</xref>c by using Equation (12), and mass flow rate in <xref ref-type="fig" rid="materials-12-02465-f004">Figure 4</xref>d. The mass flow rate in <xref ref-type="fig" rid="materials-12-02465-f004">Figure 4</xref>d is coupled with the delay time in distribution temperature, i.e., the amount of time it takes for the temperature leaving the CHP to arrive to Tillberga. During this period, the maximum and minimum observed flow rates were 33.5 and 14 <inline-formula><mml:math id="mm176"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="mm177"><mml:mrow><mml:msup><mml:mi mathvariant="normal">s</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mo>1</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> with a corresponding delay of 4.4 and <inline-formula><mml:math id="mm178"><mml:mrow><mml:mrow><mml:mn>10</mml:mn><mml:mo>.</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> h respectively.</p></sec><sec id="sec4dot2-materials-12-02465"><title>4.2. Control Implementation</title><p>The purpose of the presented control approach is to reduce DHN supply loads by lowering distribution temperatures while maintaining a more consistent (lower variance) and lower return temperature. This is accomplished by controlling the return temperature close to a set-point by using network supply temperature and mass flow rate as actuators, and a prediction of the load is used as a feed-forward signal to the controller. Substations in DHN control the amount of water in order to meet the variations in load demand which affects the pressure drop in that part of the network. The change in the pressure drop is sequentially resolved by circulation pumps since the pressure drop and water speed are directly linked. Furthermore, as the water flow increases so does the pressure drop since the water speed is proportional to the square root of the pressure difference [<xref rid="B29-materials-12-02465" ref-type="bibr">29</xref>]. Therefore, based on the previously mentioned connection, the mass flow in DHN can be viewed as a controllable action connected to circulation pumps. In the control results to be presented, it can be observed that the new control results remain within the limits of the historical mass flow rates, which implies that the pressure drop also remains within the network limits.</p><p>By coupling the designed FFMPC with the validated physical model, it was possible to evaluate the new control performance against historical processes data as illustrated in <xref ref-type="fig" rid="materials-12-02465-f005">Figure 5</xref>. The overview expresses a need for two explicit inputs: the actual end-user load (<inline-formula><mml:math id="mm179"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Q</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mrow><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> [MW]) at time <inline-formula><mml:math id="mm180"><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, and the actual load (<inline-formula><mml:math id="mm181"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Q</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mrow><mml:mi>d</mml:mi><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> [MW]) at time <italic>k</italic> is used as a measurable disturbance to the MPC.</p><p>The output signals from the FFMPC are the mass flow rate (<inline-formula><mml:math id="mm182"><mml:mrow><mml:mover accent="true"><mml:mi>m</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>) and supply temperature from the CHP (<inline-formula><mml:math id="mm183"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>). These signals are used as input into the physical model, which then calculates the network heat propagation as was illustrated in <xref ref-type="fig" rid="materials-12-02465-f004">Figure 4</xref>a. At time <inline-formula><mml:math id="mm184"><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> the actual heat demand is injected into the physical model in order to calculate the return temperature to the CHP (<inline-formula><mml:math id="mm185"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>r</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>) which is the control signal of interest. The error that arises between the resulting return temperature and the desired temperature is assessed in the MPC. At time <italic>k</italic> the MPC utilizes the internal model and feed-forward signal to predict the trajectory of future inputs and output, where it attempts to minimize the error over the prediction horizon. The MPC only applies the first step in the optimal sequence to the physical model in order to achieve the desired return temperature. At time <inline-formula><mml:math id="mm186"><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> the controller obtains a new error, the prediction horizon shifts forward, and the process of obtaining optimal control moves repeats. <xref ref-type="fig" rid="materials-12-02465-f005">Figure 5</xref> outlines two scenarios: Scenario 1 simulates the case of knowing the exact level at which the disturbance will be initiated, i.e., feed-forward the real (historical) load, and Scenario 2 is evaluated by using a load prediction model. The prediction model was derived from historical load and ambient temperatures and is expressed in Equation (21):
<disp-formula id="FD21-materials-12-02465"><label>(21)</label><mml:math id="mm187"><mml:mrow><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Q</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Q</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Q</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mrow><mml:mi>a</mml:mi><mml:mi>v</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Q</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mrow><mml:mi>a</mml:mi><mml:mi>v</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:msub><mml:mi>b</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="mm188"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Q</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is the current load of the end-user [<inline-formula><mml:math id="mm189"><mml:mrow><mml:mi mathvariant="normal">M</mml:mi></mml:mrow></mml:math></inline-formula><inline-formula><mml:math id="mm190"><mml:mrow><mml:mi mathvariant="normal">W</mml:mi></mml:mrow></mml:math></inline-formula>], <inline-formula><mml:math id="mm191"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Q</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mrow><mml:mi>a</mml:mi><mml:mi>v</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the daily hourly average of the historical load for winter periods at the current time <italic>k</italic> and 6 h ahead <inline-formula><mml:math id="mm192"><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="mm193"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the outdoor temperature at the current time <italic>k</italic> and six hours ahead <inline-formula><mml:math id="mm194"><mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>, and c signifies the impact of the outdoor temperature on the prediction.</p><p>Illustrated in <xref ref-type="fig" rid="materials-12-02465-f006">Figure 6</xref> are the control results of Scenario 1 from implementing FFMPC for the month of January in 2017 using the load depicted in <xref ref-type="fig" rid="materials-12-02465-f004">Figure 4</xref>c. The old (historical) and new control trends are represented as black- and red-plots respectively. It can be observed in <xref ref-type="fig" rid="materials-12-02465-f006">Figure 6</xref>a that the new control scheme produces a lower CHP supply temperature. Therefore, a lower supply temperature and mass flow rate to the end-user can be achieved, as illustrated in <xref ref-type="fig" rid="materials-12-02465-f006">Figure 6</xref>b,d respectively. The return temperature from the end-user has a set-point of 35 <inline-formula><mml:math id="mm195"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>&#x02218;</mml:mo></mml:msup><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> and it can be observed in <xref ref-type="fig" rid="materials-12-02465-f006">Figure 6</xref>c that the controller is able to maintain the return temperature around this point with a much smaller variance compared to the old control strategy.</p><p>Illustrated in <xref ref-type="fig" rid="materials-12-02465-f007">Figure 7</xref> are the control results for Scenario 2. In this case the feed-forward load signal to the MPC was calculated from the prediction model. The assumption is that the controller will be acting on information that is currently available to the plant production management team. From the basis of ambient temperature prognosis it is possible to estimate the thermal needs of the end-user. It can be observed in <xref ref-type="fig" rid="materials-12-02465-f007">Figure 7</xref>a that the load prediction model is able to follow the amplitude of the actual load request from the end-user quite well, where the difference is represented by <inline-formula><mml:math id="mm196"><mml:mrow><mml:msub><mml:mo>&#x00394;</mml:mo><mml:mi>Q</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. It can be noticed in <xref ref-type="fig" rid="materials-12-02465-f007">Figure 7</xref>c that the controller has a difficult time managing the desired set-point of 35 <inline-formula><mml:math id="mm197"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>&#x02218;</mml:mo></mml:msup><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. This can be attributed to the fact that the feed-forward signal is only a prediction of the actual heating needs. Therefore, the controller&#x02019;s supply temperature to the end-user illustrated in <xref ref-type="fig" rid="materials-12-02465-f007">Figure 7</xref>b is not an accurate representation of peak load requirements. Based upon this miss-match it can be observed in <xref ref-type="fig" rid="materials-12-02465-f007">Figure 7</xref>d that the mass flow rate is adjusted, but is unable to effectively accommodate for deviations in the predicted load in regards to the actual load. The average and standard deviation for the new controlled return temperature are found to be <inline-formula><mml:math id="mm198"><mml:mrow><mml:mrow><mml:mi>&#x003bc;</mml:mi><mml:mo>=</mml:mo><mml:mn>35</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm199"><mml:mrow><mml:mrow><mml:mi>&#x003c3;</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn><mml:mo>.</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula> respectively, where the standard deviation is roughly three times higher than it was for Scenario 1. This highlights the importance of the feed-forward signal. A better prediction model would lead to a lower variance in the return temperature, as is illustrated in <xref ref-type="fig" rid="materials-12-02465-f006">Figure 6</xref>c, which suggest the potential for reducing the return temperature set-point and further increasing energy savings. From the normal distribution it is then determined that for 88.5% of the time the return temperature is within the bounds of &#x000b1; 5 <inline-formula><mml:math id="mm200"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>&#x02218;</mml:mo></mml:msup><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> of the set-point. For the other 11.5% of the time the maximum and minimum new return temperatures are found to be <inline-formula><mml:math id="mm201"><mml:mrow><mml:mrow><mml:mn>24</mml:mn><mml:mo>.</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="mm202"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>&#x02218;</mml:mo></mml:msup><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm203"><mml:mrow><mml:mrow><mml:mn>44</mml:mn><mml:mo>.</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="mm204"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>&#x02218;</mml:mo></mml:msup><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> respectively, which is still within the limits of the old control in <xref ref-type="fig" rid="materials-12-02465-f007">Figure 7</xref>c.</p></sec><sec id="sec4dot3-materials-12-02465"><title>4.3. Control Performance and Assessment</title><p>An evaluation of the controller&#x02019;s performance in regards to Scenario 1 has been assessed in order to highlight the potential improvements and is illustrated in <xref ref-type="fig" rid="materials-12-02465-f008">Figure 8</xref>. From the control results obtained in <xref ref-type="fig" rid="materials-12-02465-f006">Figure 6</xref> it was shown that utilizing FFMPC led to a reduction not only in frequency but also in amplitude of the CHP supply temperature and the network mass flow rate. The added value of developing and validating a physical model of the system provides the means to compare historical values to the new control results, since the new approach allows for a lower distribution temperature. It can be observed in <xref ref-type="fig" rid="materials-12-02465-f008">Figure 8</xref>a that the highest and lowest associated heat losses over the duration of the distribution line from a historical view point are <inline-formula><mml:math id="mm205"><mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mn>15</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="mm206"><mml:mrow><mml:mi mathvariant="normal">M</mml:mi></mml:mrow></mml:math></inline-formula><inline-formula><mml:math id="mm207"><mml:mrow><mml:mi mathvariant="normal">W</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm208"><mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>73</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="mm209"><mml:mrow><mml:mi mathvariant="normal">M</mml:mi></mml:mrow></mml:math></inline-formula><inline-formula><mml:math id="mm210"><mml:mrow><mml:mi mathvariant="normal">W</mml:mi></mml:mrow></mml:math></inline-formula> respectively, with an average overall heat loss of <inline-formula><mml:math id="mm211"><mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>89</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="mm212"><mml:mrow><mml:mi mathvariant="normal">M</mml:mi></mml:mrow></mml:math></inline-formula><inline-formula><mml:math id="mm213"><mml:mrow><mml:mi mathvariant="normal">W</mml:mi></mml:mrow></mml:math></inline-formula>. The heat loss calculation was calculated using Equation (<xref ref-type="disp-formula" rid="FD2-materials-12-02465">2</xref>), where it was shown in <xref ref-type="fig" rid="materials-12-02465-f004">Figure 4</xref> that the system of equations used can predict the propagation of heat and associated losses. In comparison, the highest and lowest heat losses over the distribution line from Scenario 1 are <inline-formula><mml:math id="mm214"><mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>97</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="mm215"><mml:mrow><mml:mi mathvariant="normal">M</mml:mi></mml:mrow></mml:math></inline-formula><inline-formula><mml:math id="mm216"><mml:mrow><mml:mi mathvariant="normal">W</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm217"><mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>69</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="mm218"><mml:mrow><mml:mi mathvariant="normal">M</mml:mi></mml:mrow></mml:math></inline-formula><inline-formula><mml:math id="mm219"><mml:mrow><mml:mi mathvariant="normal">W</mml:mi></mml:mrow></mml:math></inline-formula> respectively, with an average overall heat loss of <inline-formula><mml:math id="mm220"><mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>80</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="mm221"><mml:mrow><mml:mi mathvariant="normal">M</mml:mi></mml:mrow></mml:math></inline-formula><inline-formula><mml:math id="mm222"><mml:mrow><mml:mi mathvariant="normal">W</mml:mi></mml:mrow></mml:math></inline-formula>. This results in an average reduction of 10.5% compared to the historical value. Illustrated in <xref ref-type="fig" rid="materials-12-02465-f008">Figure 8</xref>b it can be observed that the heat losses are reduced despite the outdoor ambient temperature, which varies from <inline-formula><mml:math id="mm223"><mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>20</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="mm224"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>&#x02218;</mml:mo></mml:msup><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> to 5 <inline-formula><mml:math id="mm225"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>&#x02218;</mml:mo></mml:msup><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. Illustrated in <xref ref-type="fig" rid="materials-12-02465-f008">Figure 8</xref>c,d are the calculated temperature losses, using Equation (10), from the CHP to the end-user in respects to the mass flow rate and ambient outdoor temperature respectively. The average temperature loss for the historical and control perspectives are <inline-formula><mml:math id="mm226"><mml:mrow><mml:mrow><mml:mn>5</mml:mn><mml:mo>.</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="mm227"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>&#x02218;</mml:mo></mml:msup><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm228"><mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:mo>.</mml:mo><mml:mn>9</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="mm229"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>&#x02218;</mml:mo></mml:msup><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> respectively. In <xref ref-type="fig" rid="materials-12-02465-f008">Figure 8</xref>c it can be observed that the historical values for mass flow rate exceed the controlled maximum value of <inline-formula><mml:math id="mm230"><mml:mrow><mml:mn>27.85</mml:mn></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="mm231"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="mm232"><mml:mrow><mml:msup><mml:mi mathvariant="normal">s</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. This highlights the fact that even with overall lower network flow rates, it is still possible to reduce the network temperature losses. The reduction in losses can be further explained by the reduction in the network supply temperature as illustrated in <xref ref-type="fig" rid="materials-12-02465-f008">Figure 8</xref>e. The heat flux in the supply and return lines is illustrated in <xref ref-type="fig" rid="materials-12-02465-f008">Figure 8</xref>f, and was derived by using Equation (15). In regards to the heat being supplied to the end-user, the new control case shows the potential in peak load reduction, i.e., Old<sub>supply</sub>&#x02013;New<sub>supply</sub>. The average reduction in peak load being supplied to the end-user is found to be <inline-formula><mml:math id="mm233"><mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>78</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="mm234"><mml:mrow><mml:mi mathvariant="normal">M</mml:mi></mml:mrow></mml:math></inline-formula><inline-formula><mml:math id="mm235"><mml:mrow><mml:mi mathvariant="normal">W</mml:mi></mml:mrow></mml:math></inline-formula> with a maximum reduction of <inline-formula><mml:math id="mm236"><mml:mrow><mml:mrow><mml:mn>4</mml:mn><mml:mo>.</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="mm237"><mml:mrow><mml:mi mathvariant="normal">M</mml:mi></mml:mrow></mml:math></inline-formula><inline-formula><mml:math id="mm238"><mml:mrow><mml:mi mathvariant="normal">W</mml:mi></mml:mrow></mml:math></inline-formula>. For the case of the return heat, New<sub>return</sub>, the control results lead to more stability in the return line due to the reduced variance in the mass flow rate. From the supply and return profiles it was possible to calculate an average overall savings of 254 <inline-formula><mml:math id="mm239"><mml:mrow><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:math></inline-formula><inline-formula><mml:math id="mm240"><mml:mrow><mml:mi mathvariant="normal">W</mml:mi></mml:mrow></mml:math></inline-formula> by using Equation (22):
<disp-formula id="FD22-materials-12-02465"><label>(22)</label><mml:math id="mm241"><mml:mrow><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover><mml:mi>X</mml:mi><mml:mo>&#x000af;</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover></mml:mstyle><mml:mrow><mml:mo>[</mml:mo><mml:mover accent="true"><mml:mi>m</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mi>c</mml:mi><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mover accent="true"><mml:mi>m</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover><mml:mi>c</mml:mi><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mi>n</mml:mi></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="mm242"><mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="mm243"><mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> are the CHP supply and end-user return temperatures ( <inline-formula><mml:math id="mm244"><mml:mrow><mml:mi mathvariant="normal">K</mml:mi></mml:mrow></mml:math></inline-formula>) for the historic (old) and control (new) results respectively, <inline-formula><mml:math id="mm245"><mml:mrow><mml:mover accent="true"><mml:mi>m</mml:mi><mml:mo>&#x002d9;</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> ( <inline-formula><mml:math id="mm246"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="mm247"><mml:mrow><mml:msup><mml:mi mathvariant="normal">s</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>) is the mass flow rate in the DHN and is considered to be the same in the supply and return lines, <italic>c</italic> is the specific heat ( <inline-formula><mml:math id="mm248"><mml:mrow><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:math></inline-formula><inline-formula><mml:math id="mm249"><mml:mrow><mml:mi mathvariant="normal">J</mml:mi></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="mm250"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula><inline-formula><mml:math id="mm251"><mml:mrow><mml:mi mathvariant="normal">K</mml:mi></mml:mrow></mml:math></inline-formula>), <italic>i</italic> is the index of the summation starting in January, and <italic>n</italic> is the number of samples.</p><p>To quantify the performance of each control scenario a performance assessment is outlined in <xref rid="materials-12-02465-t001" ref-type="table">Table 1</xref>. For each scenario the supply and return streams are outlined accordingly, where the historical values are the same for each case. To assess the performance of the two scenarios the average and standard deviations are taken for the supply-, return temperature, and the mass flow rate. The performance of Scenario 1 shows that the controller is able to supply a lower average temperature of <inline-formula><mml:math id="mm252"><mml:mrow><mml:mn>82.3</mml:mn></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="mm253"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>&#x02218;</mml:mo></mml:msup><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>.</p><p>It was illustrated in <xref ref-type="fig" rid="materials-12-02465-f008">Figure 8</xref>a that a reduction in the CHP supply temperature leads to lower losses, where it is calculated that a heat reduction of 12.5% can be achieved with the new supply temperature. The reduction in the heat supplied was calculated by taking the percent difference of the heat calculated in <xref rid="materials-12-02465-t001" ref-type="table">Table 1</xref>, which is based on Equation (14). In regards to the mass flow rate the performance of Scenario 1 is able to reduce the average mass flow rate from <inline-formula><mml:math id="mm254"><mml:mrow><mml:mn>22.6</mml:mn></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="mm255"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="mm2158947"><mml:mrow><mml:msup><mml:mi mathvariant="normal">s</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> to 21 <inline-formula><mml:math id="mm257"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="mm258"><mml:mrow><mml:msup><mml:mi mathvariant="normal">s</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. The calculated standard deviation of the new mass flow rate also shows that there is less variation in the network flow which reduces the possible stress on the network. The performance of Scenario 2 shows a heat reduction of 13.7% on the supply side, the highest of both cases. The average supply temperature is found to be higher than Scenario 1 and is why the average mass flow rate is lower than Scenario 1. This is because a lower mass flow rate means that there is more time for heat to be extracted from the network and therefore a higher temperature is required. The prediction model used, illustrated in <xref ref-type="fig" rid="materials-12-02465-f007">Figure 7</xref>a, shows that the predicted load (feed-forward disturbance) follows the amplitude of the historical values quite well. The difference between the historical and predicted load illustrates a fluctuation of approximately &#x000b1; 1 MW, and explains why the variation around the return temperature set-point exhibits a high degree in excitation.</p><p>In regards to the contingency of the controller&#x02019;s capability of managing a proposed set-point of 35 <inline-formula><mml:math id="mm259"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>&#x02218;</mml:mo></mml:msup><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, a sensitivity analysis for varying set-points is illustrated in <xref ref-type="fig" rid="materials-12-02465-f009">Figure 9</xref>. In <xref ref-type="fig" rid="materials-12-02465-f009">Figure 9</xref>a the average return temperatures for each scenario are given in respects to the change in set-point. The error bars represent 1 standard deviation and therefore 68% of the return temperature values can be considered to be within these regions. Illustrated in <xref ref-type="fig" rid="materials-12-02465-f009">Figure 9</xref>b are the percentages of return temperatures found to be below 30 <inline-formula><mml:math id="mm260"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>&#x02218;</mml:mo></mml:msup><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. If it is considered that 30 <inline-formula><mml:math id="mm261"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>&#x02218;</mml:mo></mml:msup><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> is the lowest allowable limit for a return temperature, then Scenario 1 could have a return temperature set-point of 33 <inline-formula><mml:math id="mm262"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>&#x02218;</mml:mo></mml:msup><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, and Scenario 2 would require a set-point of 38 <inline-formula><mml:math id="mm263"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>&#x02218;</mml:mo></mml:msup><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>. <xref ref-type="fig" rid="materials-12-02465-f009">Figure 9</xref>c illustrates the potential in the heat load reduction from the CHP. It is interesting to note that Scenario 1 under-performs in comparison to Scenarios 2. However, this can be explained by observing <xref ref-type="fig" rid="materials-12-02465-f009">Figure 9</xref>d, in which the average rate of heat being supplied for the control period is given at each set-point step. It displays that the average rate of heat supplied in Scenario 1 exceeds that of Scenario 2 and that the percentage of peak load reduction is reflected in this. This also suggests that the use of a load prediction can potentially underestimate the load requirements. <xref ref-type="fig" rid="materials-12-02465-f009">Figure 9</xref>e displays the impact of being able to control the return temperature more consistently, and is calculated using Equation (22). Since Scenario 1 is able to maintain the set-point with the most consistency it can be observed that Scenario 1 provides the highest potential for savings because the set-point can be set much lower than Scenario 2.</p></sec></sec><sec sec-type="conclusions" id="sec5-materials-12-02465"><title>5. Conclusions</title><p>Presented in this work is a method for the modelling and control of a district heating network. The prospects of evaluating the thermal dynamics inherent in district heating networks is achievable through the development of a simplified dynamic physical model. Furthermore, the validation of the physical model provides the basis from which model based control can be implemented. From the identification process it was determined that a first order discrete-time ARMAX model could be used as the model predictive controller&#x02019;s internal model. In order to determine the feasibility of reducing network supply temperatures and to assess the potential energy savings two scenarios were evaluated. It was determined that it is achievable to reduce the average network supply temperature by <inline-formula><mml:math id="mm264"><mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mo>.</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="mm265"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>&#x02218;</mml:mo></mml:msup><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> and 4 <inline-formula><mml:math id="mm266"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>&#x02218;</mml:mo></mml:msup><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> respectively, and the percent in CHP heat load reduction is found in each scenario to be 12.5%, and 13.7% respectively for the analysed time period.</p><p>Model predictive control with feed-forward shows a significant potential in reducing network return temperatures and peak load production, but is subject to the quality of the signal being fed-forward in time to the controller. This is illustrated by comparing Scenarios 1 and 2, where a prediction model approach could limit the return temperature set-point. If a lower limit of the return temperature is to be required, i.e., 30 <inline-formula><mml:math id="mm267"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>&#x02218;</mml:mo></mml:msup><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, then the set-point of the controller will be dictated by the quality of the feed-forward signal. This is apparent when looking at Scenario 2, which would require a return temperature set-point of 38 <inline-formula><mml:math id="mm268"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>&#x02218;</mml:mo></mml:msup><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula> due to the degree of variance observed in the return temperature. However, despite this increase in the set-point, Scenario 2 would still be able to provide an average overall savings of 222 <inline-formula><mml:math id="mm269"><mml:mrow><mml:mi mathvariant="normal">k</mml:mi></mml:mrow></mml:math></inline-formula><inline-formula><mml:math id="mm270"><mml:mrow><mml:mi mathvariant="normal">W</mml:mi></mml:mrow></mml:math></inline-formula>. Therefore, the inclusion of more accurate load prediction models would enable the ability to reduce the return temperature set-point due to a lower variation in the return temperature signal, and would contribute to higher energy savings. Faster sampling time could also be considered, since the feedback would then be able to compensate for poor load predictions earlier.</p></sec></body><back><ack><title>Acknowledgments</title><p>The authors want to acknowledge M&#x000e4;larenergi AB, V&#x000e4;ster&#x000e5;s, Sweden, for their support in data acquisition and process information.</p></ack><notes><title>Author Contributions</title><p>The manuscript was conceptualized by all three authors, N.Z. developed the models, analyzed results, and wrote the manuscript, K.K. contributed in model methodology and validation and manuscript review and editing, and C.-F.L. contributed in control methodology and implementation, and manuscript review and editing.</p></notes><notes><title>Funding</title><p>The funding for this research is supported by VINNOVA and The Strategic Innovation Programme for Process Industrial IT and Automation (PiiA), reference number 2016-02395.</p></notes><notes notes-type="COI-statement"><title>Conflicts of Interest</title><p>The authors declare no conflict of interest.</p></notes><ref-list><title>References</title><ref id="B1-materials-12-02465"><label>1.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Werner</surname><given-names>S.</given-names></name></person-group><article-title>International review of district heating and cooling</article-title><source>Energy</source><year>2017</year><volume>137</volume><fpage>617</fpage><lpage>631</lpage><pub-id pub-id-type="doi">10.1016/j.energy.2017.04.045</pub-id></element-citation></ref><ref id="B2-materials-12-02465"><label>2.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Averfalk</surname><given-names>H.</given-names></name><name><surname>Werner</surname><given-names>S.</given-names></name></person-group><article-title>Novel low temperature heat distribution technology</article-title><source>Energy</source><year>2018</year><volume>145</volume><fpage>526</fpage><lpage>539</lpage><pub-id pub-id-type="doi">10.1016/j.energy.2017.12.157</pub-id></element-citation></ref><ref id="B3-materials-12-02465"><label>3.</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Nord</surname><given-names>N.</given-names></name><name><surname>Schmidt</surname><given-names>D.</given-names></name><name><surname>Kallert</surname><given-names>A.</given-names></name><name><surname>Svendsen</surname><given-names>S.</given-names></name></person-group><article-title>Improved Interfaces for Enabling Integration of Low Temperature and Distributed Heat Sources&#x02014;Requirements and Examples</article-title><source>Proceedings of the CLIMA 2016&#x02014;Proceedings of the 12th REHVA World Congress</source><conf-loc>Aalborg, Denmark</conf-loc><conf-date>22&#x02013;25 May 2016</conf-date></element-citation></ref><ref id="B4-materials-12-02465"><label>4.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gadd</surname><given-names>H.</given-names></name><name><surname>Werner</surname><given-names>S.</given-names></name></person-group><article-title>Fault detection in district heating substations</article-title><source>Appl. Energy</source><year>2015</year><volume>157</volume><fpage>51</fpage><lpage>59</lpage><pub-id pub-id-type="doi">10.1016/j.apenergy.2015.07.061</pub-id></element-citation></ref><ref id="B5-materials-12-02465"><label>5.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Flores</surname><given-names>J.F.</given-names></name><name><surname>Lacarri&#x000e8;re</surname><given-names>B.</given-names></name><name><surname>Chiu</surname><given-names>J.N.</given-names></name><name><surname>Martin</surname><given-names>V.</given-names></name></person-group><article-title>Assessing the techno-economic impact of low-temperature subnets in conventional district heating networks</article-title><source>Energy Procedia</source><year>2017</year><volume>116</volume><fpage>260</fpage><lpage>272</lpage><pub-id pub-id-type="doi">10.1016/j.egypro.2017.05.073</pub-id></element-citation></ref><ref id="B6-materials-12-02465"><label>6.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nord</surname><given-names>N.</given-names></name><name><surname>L&#x000f8;ve Nielsen</surname><given-names>E.K.</given-names></name><name><surname>Kauko</surname><given-names>H.</given-names></name><name><surname>Tereshchenko</surname><given-names>T.</given-names></name></person-group><article-title>Challenges and potentials for low-temperature district heating implementation in Norway</article-title><source>Energy</source><year>2018</year><volume>151</volume><fpage>889</fpage><lpage>902</lpage><pub-id pub-id-type="doi">10.1016/j.energy.2018.03.094</pub-id></element-citation></ref><ref id="B7-materials-12-02465"><label>7.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schmidt</surname><given-names>D.</given-names></name><name><surname>Kallert</surname><given-names>A.</given-names></name><name><surname>Blesl</surname><given-names>M.</given-names></name><name><surname>Svendsen</surname><given-names>S.</given-names></name><name><surname>Li</surname><given-names>H.</given-names></name><name><surname>Nord</surname><given-names>N.</given-names></name><name><surname>Sipil&#x000e4;</surname><given-names>K.</given-names></name></person-group><article-title>Low Temperature District Heating for Future Energy Systems</article-title><source>Energy Procedia</source><year>2018</year><volume>149</volume><fpage>595</fpage><lpage>604</lpage><pub-id pub-id-type="doi">10.1016/j.egypro.2018.08.224</pub-id></element-citation></ref><ref id="B8-materials-12-02465"><label>8.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lund</surname><given-names>H.</given-names></name><name><surname>Werner</surname><given-names>S.</given-names></name><name><surname>Wiltshire</surname><given-names>R.</given-names></name><name><surname>Svendsen</surname><given-names>S.</given-names></name><name><surname>Thorsen</surname><given-names>J.E.</given-names></name><name><surname>Hvelplund</surname><given-names>F.</given-names></name><name><surname>Mathiesen</surname><given-names>B.V.</given-names></name></person-group><article-title>4th Generation District Heating (4GDH). Integrating smart thermal grids into future sustainable energy systems</article-title><source>Energy</source><year>2014</year><volume>68</volume><fpage>1</fpage><lpage>11</lpage><pub-id pub-id-type="doi">10.1016/j.energy.2014.02.089</pub-id></element-citation></ref><ref id="B9-materials-12-02465"><label>9.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gadd</surname><given-names>H.</given-names></name><name><surname>Werner</surname><given-names>S.</given-names></name></person-group><article-title>Achieving low return temperatures from district heating substations</article-title><source>Appl. Energy</source><year>2014</year><volume>136</volume><fpage>59</fpage><lpage>67</lpage><pub-id pub-id-type="doi">10.1016/j.apenergy.2014.09.022</pub-id></element-citation></ref><ref id="B10-materials-12-02465"><label>10.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gabrielaitiene</surname><given-names>I.</given-names></name><name><surname>B&#x000f8;hm</surname><given-names>B.</given-names></name><name><surname>Sunden</surname><given-names>B.</given-names></name></person-group><article-title>Modelling temperature dynamics of a district heating system in Naestved, Denmark&#x02014;A case study</article-title><source>Energy Convers. Manag.</source><year>2007</year><volume>48</volume><fpage>78</fpage><lpage>86</lpage><pub-id pub-id-type="doi">10.1016/j.enconman.2006.05.011</pub-id></element-citation></ref><ref id="B11-materials-12-02465"><label>11.</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Giraud</surname><given-names>L.</given-names></name><name><surname>Baviere</surname><given-names>R.</given-names></name><name><surname>Vall&#x000e9;e</surname><given-names>M.</given-names></name><name><surname>Paulus</surname><given-names>C.</given-names></name></person-group><article-title>Presentation, Validation and Application of the DistrictHeating Modelica Library</article-title><source>Proceedings of the 11th Modelica Conference</source><conf-loc>Versailles, France</conf-loc><conf-date>21&#x02013;23 September 2015</conf-date><fpage>79</fpage><lpage>88</lpage><pub-id pub-id-type="doi">10.3384/ecp1511879</pub-id></element-citation></ref><ref id="B12-materials-12-02465"><label>12.</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Soons</surname><given-names>F.</given-names></name><name><surname>Torrens Galdiz</surname><given-names>J.</given-names></name><name><surname>Hensen</surname><given-names>J.</given-names></name><name><surname>Schrevel</surname><given-names>R.</given-names></name></person-group><article-title>A Modelica based computational model for evaluating a renewable district heating system</article-title><source>Proceedings of the 9th International Conference on System Simulation in Buildings</source><conf-loc>Liege, Belgium</conf-loc><conf-date>10&#x02013;12 December 2014</conf-date><fpage>1</fpage><lpage>16</lpage></element-citation></ref><ref id="B13-materials-12-02465"><label>13.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hermansson</surname><given-names>K.</given-names></name><name><surname>Kos</surname><given-names>C.</given-names></name><name><surname>Starfelt</surname><given-names>F.</given-names></name><name><surname>Kyprianidis</surname><given-names>K.</given-names></name><name><surname>Lindberg</surname><given-names>C.F.</given-names></name><name><surname>Zimmerman</surname><given-names>N.</given-names></name></person-group><article-title>An Automated Approach to Building and Simulating Dynamic District Heating Networks</article-title><source>IFAC-PapersOnLine</source><year>2018</year><volume>51</volume><fpage>855</fpage><lpage>860</lpage><pub-id pub-id-type="doi">10.1016/j.ifacol.2018.04.021</pub-id></element-citation></ref><ref id="B14-materials-12-02465"><label>14.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schweiger</surname><given-names>G.</given-names></name><name><surname>Larsson</surname><given-names>P.O.</given-names></name><name><surname>Magnusson</surname><given-names>F.</given-names></name><name><surname>Lauenburg</surname><given-names>P.</given-names></name><name><surname>Velut</surname><given-names>S.</given-names></name></person-group><article-title>District heating and cooling systems&#x02014;Framework for Modelica-based simulation and dynamic optimization</article-title><source>Energy</source><year>2017</year><volume>137</volume><fpage>566</fpage><lpage>578</lpage><pub-id pub-id-type="doi">10.1016/j.energy.2017.05.115</pub-id></element-citation></ref><ref id="B15-materials-12-02465"><label>15.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kauko</surname><given-names>H.</given-names></name><name><surname>Kvalsvik</surname><given-names>K.H.</given-names></name><name><surname>Rohde</surname><given-names>D.</given-names></name><name><surname>Nord</surname><given-names>N.</given-names></name><name><surname>Utne</surname><given-names>&#x000c5;.</given-names></name></person-group><article-title>Dynamic modeling of local district heating grids with prosumers: A case study for Norway</article-title><source>Energy</source><year>2018</year><volume>151</volume><fpage>261</fpage><lpage>271</lpage><pub-id pub-id-type="doi">10.1016/j.energy.2018.03.033</pub-id></element-citation></ref><ref id="B16-materials-12-02465"><label>16.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Laakkonen</surname><given-names>L.</given-names></name><name><surname>Korpela</surname><given-names>T.</given-names></name><name><surname>Kaivosoja</surname><given-names>J.</given-names></name><name><surname>Vilkko</surname><given-names>M.</given-names></name><name><surname>Majanne</surname><given-names>Y.</given-names></name><name><surname>Nurmoranta</surname><given-names>M.</given-names></name></person-group><article-title>Predictive Supply Temperature Optimization of District Heating Networks Using Delay Distributions</article-title><source>Energy Procedia</source><year>2017</year><volume>116</volume><fpage>297</fpage><lpage>309</lpage><pub-id pub-id-type="doi">10.1016/j.egypro.2017.05.076</pub-id></element-citation></ref><ref id="B17-materials-12-02465"><label>17.</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Sandou</surname><given-names>G.</given-names></name><name><surname>Font</surname><given-names>S.</given-names></name><name><surname>Tebbani</surname><given-names>S.</given-names></name><name><surname>Hiret</surname><given-names>A.</given-names></name><name><surname>Mondon</surname><given-names>C.</given-names></name></person-group><article-title>Predictive Control of a Complex District Heating Network Qk</article-title><source>Proceedings of the 44th IEEE Conference on Decision and Control, and the European Control Conference 2005</source><conf-loc>Seville, Spain</conf-loc><conf-date>12&#x02013;15 December 2005</conf-date><fpage>7372</fpage><lpage>7377</lpage></element-citation></ref><ref id="B18-materials-12-02465"><label>18.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Grosswindhager</surname><given-names>S.</given-names></name><name><surname>Kozek</surname><given-names>M.</given-names></name><name><surname>Voigt</surname><given-names>A.</given-names></name><name><surname>Haffner</surname><given-names>L.</given-names></name></person-group><article-title>Fuzzy predictive control of district heating network</article-title><source>Int. J. Model. Identif. Control</source><year>2012</year><volume>19</volume><fpage>161</fpage><pub-id pub-id-type="doi">10.1504/IJMIC.2013.054320</pub-id></element-citation></ref><ref id="B19-materials-12-02465"><label>19.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vandermeulen</surname><given-names>A.</given-names></name><name><surname>van der Heijde</surname><given-names>B.</given-names></name><name><surname>Helsen</surname><given-names>L.</given-names></name></person-group><article-title>Controlling district heating and cooling networks to unlock flexibility: A review</article-title><source>Energy</source><year>2018</year><volume>151</volume><fpage>103</fpage><lpage>115</lpage><pub-id pub-id-type="doi">10.1016/j.energy.2018.03.034</pub-id></element-citation></ref><ref id="B20-materials-12-02465"><label>20.</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Saarinen</surname><given-names>L.</given-names></name></person-group><article-title>Modelling and Control of a District Heating System</article-title><source>Master&#x02019;s Thesis</source><publisher-name>Department of Infomration Technology, Uppsala Univeristy</publisher-name><publisher-loc>Uppsala, Sweden</publisher-loc><year>2008</year></element-citation></ref><ref id="B21-materials-12-02465"><label>21.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Verrilli</surname><given-names>F.</given-names></name><name><surname>Srinivasan</surname><given-names>S.</given-names></name><name><surname>Gambino</surname><given-names>G.</given-names></name><name><surname>Canelli</surname><given-names>M.</given-names></name><name><surname>Himanka</surname><given-names>M.</given-names></name><name><surname>Del Vecchio</surname><given-names>C.</given-names></name><name><surname>Sasso</surname><given-names>M.</given-names></name><name><surname>Glielmo</surname><given-names>L.</given-names></name></person-group><article-title>Model Predictive Control-Based Optimal Operations of District Heating System With Thermal Energy Storage and Flexible Loads</article-title><source>IEEE Trans. Autom. Sci. Eng.</source><year>2017</year><volume>14</volume><fpage>547</fpage><lpage>557</lpage><pub-id pub-id-type="doi">10.1109/TASE.2016.2618948</pub-id></element-citation></ref><ref id="B22-materials-12-02465"><label>22.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cadau</surname><given-names>N.</given-names></name><name><surname>Lorenzi</surname><given-names>A.D.</given-names></name><name><surname>Gambarotta</surname><given-names>A.</given-names></name><name><surname>Morini</surname><given-names>M.</given-names></name><name><surname>Saletti</surname><given-names>C.</given-names></name></person-group><article-title>A Model-in-the-Loop application of a Predictive Controller to a District Heating system</article-title><source>Energy Procedia</source><year>2018</year><volume>148</volume><fpage>352</fpage><lpage>359</lpage><pub-id pub-id-type="doi">10.1016/j.egypro.2018.08.088</pub-id></element-citation></ref><ref id="B23-materials-12-02465"><label>23.</label><element-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Giraud</surname><given-names>L.</given-names></name><name><surname>Merabet</surname><given-names>M.</given-names></name><name><surname>Baviere</surname><given-names>R.</given-names></name><name><surname>Vall&#x000e9;e</surname><given-names>M.</given-names></name></person-group><article-title>Optimal Control of District Heating Systems using Dynamic Simulation and Mixed Integer Linear Programming</article-title><source>Proceedings of the 12th International Modelica Conference</source><conf-loc>Prague, Czech Republic</conf-loc><conf-date>15&#x02013;17 May 2017</conf-date><fpage>141</fpage><lpage>150</lpage><pub-id pub-id-type="doi">10.3384/ecp17132141</pub-id></element-citation></ref><ref id="B24-materials-12-02465"><label>24.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Dalla Rosa</surname><given-names>A.</given-names></name><name><surname>Li</surname><given-names>H.</given-names></name><name><surname>Svendsen</surname><given-names>S.</given-names></name></person-group><article-title>Method for optimal design of pipes for low-energy district heating, with focus on heat losses</article-title><source>Energy</source><year>2011</year><volume>36</volume><fpage>2407</fpage><lpage>2418</lpage><pub-id pub-id-type="doi">10.1016/j.energy.2011.01.024</pub-id></element-citation></ref><ref id="B25-materials-12-02465"><label>25.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tor&#x000ed;o</surname><given-names>H.</given-names></name><name><surname>Schmidt</surname><given-names>D.</given-names></name></person-group><article-title>Development of system concepts for improving the performance of a waste heat district heating network with exergy analysis</article-title><source>Energy Build.</source><year>2010</year><volume>42</volume><fpage>1601</fpage><lpage>1609</lpage><pub-id pub-id-type="doi">10.1016/j.enbuild.2010.04.002</pub-id></element-citation></ref><ref id="B26-materials-12-02465"><label>26.</label><element-citation publication-type="web"><person-group person-group-type="author"><collab>Statistics Sweden (SCB)</collab></person-group><article-title>Population and Land Area within Localities, by Locality. Every Fifth Year 1960&#x02013;2018</article-title><year>2018</year><comment>Available online: <ext-link ext-link-type="uri" xlink:href="http://www.statistikdatabasen.scb.se/pxweb/en/ssd/START__MI__MI0810__MI0810A/LandarealTatort/">http://www.statistikdatabasen.scb.se/pxweb/en/ssd/START__MI__MI0810__MI0810A/LandarealTatort/</ext-link></comment><date-in-citation content-type="access-date" iso-8601-date="2019-08-01">(accessed on 1 August 2019)</date-in-citation></element-citation></ref><ref id="B27-materials-12-02465"><label>27.</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Yliniemi</surname><given-names>K.</given-names></name></person-group><article-title>Fault Detection in District Heating Substations</article-title><source>Licentiate Thesis</source><publisher-name>Department of Computer Science and Electrical Engineering, Lue&#x000e5; University of Technology</publisher-name><publisher-loc>Lue&#x000e5;, Sweden</publisher-loc><year>2005</year></element-citation></ref><ref id="B28-materials-12-02465"><label>28.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kozak</surname><given-names>S.</given-names></name></person-group><article-title>State-of-the-art in control engineering</article-title><source>J. Electr. Syst. Inf. Technol.</source><year>2014</year><volume>1</volume><fpage>1</fpage><lpage>9</lpage><pub-id pub-id-type="doi">10.1016/j.jesit.2014.03.002</pub-id></element-citation></ref><ref id="B29-materials-12-02465"><label>29.</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Frederiksen</surname><given-names>S.</given-names></name><name><surname>Werner</surname><given-names>S.</given-names></name></person-group><source>District Heating and Cooling</source><publisher-name>Studentlitteratur AB</publisher-name><publisher-loc>Lund, Sweden</publisher-loc><year>2013</year></element-citation></ref></ref-list></back><floats-group><fig id="materials-12-02465-f001" orientation="portrait" position="float"><label>Figure 1</label><caption><p>Seasonal variation in delay time for heat being supplied to Tillberga.</p></caption><graphic xlink:href="materials-12-02465-g001"/></fig><fig id="materials-12-02465-f002" orientation="portrait" position="float"><label>Figure 2</label><caption><p>Principle components of the pipe model.</p></caption><graphic xlink:href="materials-12-02465-g002"/></fig><fig id="materials-12-02465-f003" orientation="portrait" position="float"><label>Figure 3</label><caption><p>MPC step response: (<bold>a</bold>) return temperature operating around set-point, (<bold>b</bold>) feed-forward load and actual end-user load (<bold>c</bold>) actuation of CHP supply temperature and resulting end-user supply temperature, (<bold>d</bold>) actuation of mass flow rate.</p></caption><graphic xlink:href="materials-12-02465-g003"/></fig><fig id="materials-12-02465-f004" orientation="portrait" position="float"><label>Figure 4</label><caption><p>Validation of DHN model: (<bold>a</bold>) temperature supplied to Tillberga in comparison to the temperature being supplied from the CHP, (<bold>b</bold>) return temperature to CHP from Tillberga, (<bold>c</bold>) load and outdoor temperature, (<bold>d</bold>) mass flow rate and delay time.</p></caption><graphic xlink:href="materials-12-02465-g004"/></fig><fig id="materials-12-02465-f005" orientation="portrait" position="float"><label>Figure 5</label><caption><p>Overview of FFMPC implementation and feed-forward signal: Scenario 1&#x02014;historical load and Scenario 2&#x02014;prediction model.</p></caption><graphic xlink:href="materials-12-02465-g005"/></fig><fig id="materials-12-02465-f006" orientation="portrait" position="float"><label>Figure 6</label><caption><p>Implementation of FFMPC results and comparison between actual and controlled signals, Scenario 1. (<bold>a</bold>) supply temperature from CHP, (<bold>b</bold>) supply temperature to the end-user, (<bold>c</bold>) return temperature to CHP from the end-user, and (<bold>d</bold>) mass flow rate.</p></caption><graphic xlink:href="materials-12-02465-g006"/></fig><fig id="materials-12-02465-f007" orientation="portrait" position="float"><label>Figure 7</label><caption><p>Control results for Scenario 2, using load prediction. (<bold>a</bold>) predicted load in relation to the actual load, (<bold>b</bold>) supply temperature to the end-user, (<bold>c</bold>) temperature leaving the end-user, and (<bold>d</bold>) mass flow rate of heat being delivered.</p></caption><graphic xlink:href="materials-12-02465-g007"/></fig><fig id="materials-12-02465-f008" orientation="portrait" position="float"><label>Figure 8</label><caption><p>Improvements gained from Scenario 1 (feed-forward historic load). (<bold>a</bold>,<bold>b</bold>) represent the associated heat losses in respects to CHP supply temperature and the ambient temperature respectively; (<bold>c</bold>,<bold>d</bold>) represent the temperature losses in respects to the mass flow rate and ambient temperature respectively; (<bold>e</bold>) CHP supply temperature in respects to ambient temperature; (<bold>f</bold>) Comparison between historical values (old) and control values (new) in regards to rate of heat supplied and returned in the network.</p></caption><graphic xlink:href="materials-12-02465-g008"/></fig><fig id="materials-12-02465-f009" orientation="portrait" position="float"><label>Figure 9</label><caption><p>Sensitivity test from varying the set-point on the return temperature for each scenario: (<bold>a</bold>) average return temperature, (<bold>b</bold>) percentage of temperatures occurring below 30 <inline-formula><mml:math id="mm278"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>&#x02218;</mml:mo></mml:msup><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>, (<bold>c</bold>) potential percentage in heat load reduction, (<bold>d</bold>) average rate of heat supplied, and (<bold>e</bold>) average overall savings potential.</p></caption><graphic xlink:href="materials-12-02465-g009"/></fig><table-wrap id="materials-12-02465-t001" orientation="portrait" position="float"><object-id pub-id-type="pii">materials-12-02465-t001_Table 1</object-id><label>Table 1</label><caption><p>Performance comparison for the two observed cases.</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" valign="middle" style="border-top:solid thin" rowspan="1" colspan="1">
</th><th colspan="2" align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1">Historic</th><th colspan="2" align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1">Scenario 1</th><th colspan="2" align="center" valign="middle" style="border-top:solid thin;border-bottom:solid thin" rowspan="1">Scenario 2</th></tr><tr><th align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">
</th><th align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Supply</th><th align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Return</th><th align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Supply</th><th align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Return</th><th align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Supply</th><th align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Return</th></tr></thead><tbody><tr><td align="left" valign="middle" rowspan="1" colspan="1">Temp. avg. ( <inline-formula><mml:math id="mm279"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>&#x02218;</mml:mo></mml:msup><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>)</td><td align="center" valign="middle" rowspan="1" colspan="1">86</td><td align="center" valign="middle" rowspan="1" colspan="1">39.2</td><td align="center" valign="middle" rowspan="1" colspan="1">82.3</td><td align="center" valign="middle" rowspan="1" colspan="1">35</td><td align="center" valign="middle" rowspan="1" colspan="1">86</td><td align="center" valign="middle" rowspan="1" colspan="1">35</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">Temp. std. ( <inline-formula><mml:math id="mm280"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>&#x02218;</mml:mo></mml:msup><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>)</td><td align="center" valign="middle" rowspan="1" colspan="1">6.6</td><td align="center" valign="middle" rowspan="1" colspan="1">4.4</td><td align="center" valign="middle" rowspan="1" colspan="1">3.1</td><td align="center" valign="middle" rowspan="1" colspan="1">0.9</td><td align="center" valign="middle" rowspan="1" colspan="1">3.7</td><td align="center" valign="middle" rowspan="1" colspan="1">3.1</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">Temp. loss avg. ( <inline-formula><mml:math id="mm281"><mml:mrow><mml:mrow><mml:msup><mml:mrow/><mml:mo>&#x02218;</mml:mo></mml:msup><mml:mi mathvariant="normal">C</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>)</td><td align="center" valign="middle" rowspan="1" colspan="1">5.6</td><td align="center" valign="middle" rowspan="1" colspan="1">-</td><td align="center" valign="middle" rowspan="1" colspan="1">4.8</td><td align="center" valign="middle" rowspan="1" colspan="1">-</td><td align="center" valign="middle" rowspan="1" colspan="1">5.3</td><td align="center" valign="middle" rowspan="1" colspan="1">-</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">mass flow avg. ( <inline-formula><mml:math id="mm282"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="mm283"><mml:mrow><mml:msup><mml:mi mathvariant="normal">s</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>)</td><td align="center" valign="middle" rowspan="1" colspan="1">22.6</td><td align="center" valign="middle" rowspan="1" colspan="1">-</td><td align="center" valign="middle" rowspan="1" colspan="1">21</td><td align="center" valign="middle" rowspan="1" colspan="1">-</td><td align="center" valign="middle" rowspan="1" colspan="1">19.4</td><td align="center" valign="middle" rowspan="1" colspan="1">-</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">mass flow std. ( <inline-formula><mml:math id="mm284"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">k</mml:mi><mml:mi mathvariant="normal">g</mml:mi></mml:mrow></mml:mrow></mml:math></inline-formula>
<inline-formula><mml:math id="mm285"><mml:mrow><mml:msup><mml:mi mathvariant="normal">s</mml:mi><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>)</td><td align="center" valign="middle" rowspan="1" colspan="1">3</td><td align="center" valign="middle" rowspan="1" colspan="1">-</td><td align="center" valign="middle" rowspan="1" colspan="1">2.2</td><td align="center" valign="middle" rowspan="1" colspan="1">-</td><td align="center" valign="middle" rowspan="1" colspan="1">2.2</td><td align="center" valign="middle" rowspan="1" colspan="1">-</td></tr><tr><td align="left" valign="middle" rowspan="1" colspan="1">Heat ( <inline-formula><mml:math id="mm286"><mml:mrow><mml:mi mathvariant="normal">M</mml:mi></mml:mrow></mml:math></inline-formula><inline-formula><mml:math id="mm287"><mml:mrow><mml:mi mathvariant="normal">J</mml:mi></mml:mrow></mml:math></inline-formula>)</td><td align="center" valign="middle" rowspan="1" colspan="1">16.65 &#x000d7; 10<sup>6</sup></td><td align="center" valign="middle" rowspan="1" colspan="1">47 &#x000d7; 10<sup>5</sup></td><td align="center" valign="middle" rowspan="1" colspan="1">14.57 &#x000d7; 10<sup>6</sup></td><td align="center" valign="middle" rowspan="1" colspan="1">33.1 &#x000d7; 10<sup>5</sup></td><td align="center" valign="middle" rowspan="1" colspan="1">14.36 &#x000d7; 10<sup>6</sup></td><td align="center" valign="middle" rowspan="1" colspan="1">30.5 &#x000d7; 10<sup>5</sup></td></tr><tr><td align="left" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">Heat reduced (%)</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">-</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">-</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">12.5</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">29.6</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">13.7</td><td align="center" valign="middle" style="border-bottom:solid thin" rowspan="1" colspan="1">35</td></tr></tbody></table><table-wrap-foot><fn><p>avg. = average; std. = standard deviation; &#x02019;-&#x02019; = not applicable. Scenario 1: feed-forward of historical load, Scenario 2: feed-forward of prediction load.</p></fn></table-wrap-foot></table-wrap></floats-group></article>